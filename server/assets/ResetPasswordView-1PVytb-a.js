import{W as x,r as l,X as q,n as M,$ as B,C as R,a0 as T,G as t,D as o,aW as v,a2 as N,a1 as h,z as j,aX as A,a$ as F,F as w}from"./vendor-BQXrruHR.js";import{V as I,a as L,b as C,c as P,d as U,_ as D,f as S,g as W,h as X,i as z,j as E,k as G}from"./index-B_oQPGco.js";const H={class:"d-flex justify-end mt-2"},k="Ссылка недействительна или устарела",J=x({__name:"AuthReset",setup(b){const f=A(),d=F(),n=l({password:"",passwordConfirm:""}),y=l(),m=l(!1),V=l(),c=l(!1),r=l(""),u=l(!1),i=l(!1),p={required:s=>!!s&&s.trim()!==""||"Обязательное поле",minLength:s=>e=>e&&e.length>=s||`Минимум ${s} символов`,passwordMatch:s=>s===n.value.password||"Пароли не совпадают"};q(async()=>{await M(),V.value?.focus?.()});const $=async()=>{const{valid:s}=await y.value?.validate()??{valid:!1};if(!s)return;const e=f.query.token,a=f.query.email,_=typeof e=="string"?e:"",g=typeof a=="string"?a:"";if(!_||!g){r.value=k;return}c.value=!0,r.value="";try{await U.post("/api/reset-password",{token:_,email:g,password:n.value.password,password_confirmation:n.value.passwordConfirm}),await d.replace({name:"login",query:{message:"password-reset"}})}catch{r.value=k}finally{c.value=!1}};return(s,e)=>(w(),B("div",null,[r.value?(w(),R(I,{key:0,type:"error",variant:"tonal",closable:"",class:"mb-4","onClick:close":e[0]||(e[0]=a=>r.value="")},{default:o(()=>[v(N(r.value),1)]),_:1})):T("",!0),t(L,{ref_key:"formRef",ref:y,modelValue:m.value,"onUpdate:modelValue":e[5]||(e[5]=a=>m.value=a),onSubmit:h($,["prevent"])},{default:o(()=>[t(C,{ref_key:"passwordRef",ref:V,modelValue:n.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>n.value.password=a),label:"Новый пароль",type:u.value?"text":"password",autocomplete:"new-password",rules:[p.required,p.minLength(8)],"append-inner-icon":u.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[2]||(e[2]=a=>u.value=!u.value)},null,8,["modelValue","type","rules","append-inner-icon"]),t(C,{modelValue:n.value.passwordConfirm,"onUpdate:modelValue":e[3]||(e[3]=a=>n.value.passwordConfirm=a),label:"Подтвердите пароль",type:i.value?"text":"password",autocomplete:"new-password",rules:[p.required,p.passwordMatch],"append-inner-icon":i.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[4]||(e[4]=a=>i.value=!i.value)},null,8,["modelValue","type","rules","append-inner-icon"]),j("div",H,[t(P,{color:"primary",class:"text-none",loading:c.value,disabled:!m.value,type:"submit"},{default:o(()=>[...e[6]||(e[6]=[v(" Сменить пароль ",-1)])]),_:1},8,["loading","disabled"])])]),_:1},8,["modelValue"])]))}}),K=D(J,[["__scopeId","data-v-7e8dd483"]]),Z=x({__name:"ResetPasswordView",setup(b){return(f,d)=>(w(),R(S,{class:"fill-height",fluid:""},{default:o(()=>[t(G,{align:"center",justify:"center"},{default:o(()=>[t(W,{cols:"12",sm:"8",md:"5",lg:"4"},{default:o(()=>[t(X,null,{default:o(()=>[t(z,{class:"text-h6"},{default:o(()=>[...d[0]||(d[0]=[v("Смена пароля",-1)])]),_:1}),t(E,null,{default:o(()=>[t(K)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Z as default};
