import{bg as x,F as m,z as s,B as Re,be as ql,bf as Ll,r as c,f as P,w as Ct,ac as Tl,G as a,D as o,a9 as K,bi as d,aB as u,bD as oe,bj as C,bh as he,C as g,bG as Ee,bH as Se,K as Pl,A as Ft}from"./vendor-CKnqOB-T.js";import{k as _,_ as jt,V as Oe,t as se,v as El,w as Sl,x as Ol,h as B,i as h,y as zl,b as Q,c as M,o as j,d as Y,e as Ze,f as w,z as X,r as z,A as ke,B as et,C as ne,D as Wl,n as ie,q as ae,E as $t,j as W,a as T,p as Ut,F as ze,G as We,H as Rl,I as tt,g as re,J as fe,m as Bl}from"./index-B66HMlcK.js";class Il{async getAll(q){const{data:p}=await _.get(`/api/projects/${q}/labor-works`);return Array.isArray(p)?p:p.data||[]}async create(q,p){const{data:i}=await _.post(`/api/projects/${q}/labor-works`,p);return i.data||i}async getOne(q,p){const{data:i}=await _.get(`/api/projects/${q}/labor-works/${p}`);return i.data||i}async update(q,p,i){const{data:I}=await _.put(`/api/projects/${q}/labor-works/${p}`,i);return I.data||I}async delete(q,p){await _.delete(`/api/projects/${q}/labor-works/${p}`)}async reorder(q,p){const{data:i}=await _.patch(`/api/projects/${q}/labor-works/reorder`,{order:p});return i}}const Ve=new Il,Hl={__name:"IosToggle",props:{modelValue:{type:[Boolean,Number],default:!1}},emits:["update:modelValue"],setup(Ce){return(q,p)=>(m(),x("div",{class:Re(["ios-toggle",{"is-checked":!!Ce.modelValue}]),onClick:p[0]||(p[0]=i=>q.$emit("update:modelValue",!Ce.modelValue))},[...p[1]||(p[1]=[s("div",{class:"ios-toggle-thumb"},null,-1)])],2))}},Dt=jt(Hl,[["__scopeId","data-v-8770b79c"]]),Jl={class:"d-flex align-center justify-space-between"},Gl={class:"mb-6"},Kl={class:"mb-6"},Ql={class:"d-flex align-center gap-2 mb-3"},Yl={class:"mb-6"},Xl={class:"mb-6"},Zl={class:"mb-6"},ea={class:"mb-6"},ta={key:0,class:"mb-4"},la={class:"d-flex align-center justify-space-between mb-2"},aa={class:"d-flex align-center gap-2"},oa={class:"text-caption font-weight-bold"},sa={class:"d-flex gap-1"},na={key:0,class:"text-caption text-grey mt-1"},ia={key:1,class:"mb-4"},ra={key:2,class:"text-caption text-warning"},ua={style:{"overflow-x":"auto","margin-top":"12px"}},da={class:"d-flex gap-2 align-center"},ma={class:"d-flex align-center",style:{"min-width":"24px",height:"24px"}},pa={style:{"font-weight":"400"}},ca={class:"d-flex align-center justify-space-between"},_a={key:1},va={key:0},fa={key:1},ga={key:0},ya={key:0},ba={key:0},wa={key:1},xa=["colspan"],ha={class:"text-body-2"},ka={class:"mt-2"},Va={class:"mt-2"},Ca={class:"mt-2"},Fa={class:"mb-3 pb-3 border-b"},$a={class:"mt-2"},Ua={class:"text-caption text-grey"},Da={class:"text-body-2"},ja={key:0,class:"mt-2"},Na={class:"d-flex align-center gap-2"},Aa=["colspan"],Ma={class:"text-body-2"},qa={class:"mt-2"},La={style:{"font-weight":"400"}},Ta={style:{display:"flex","align-items":"center",gap:"6px"}},Pa={style:{"text-align":"right",width:"120px"}},Ea=["colspan"],Sa={class:"text-subtitle-2 mb-3"},Oa={class:"text-caption text-grey"},za={style:{"text-align":"right"}},Wa={style:{"text-align":"right"}},Ra={class:"text-body-2"},Ba={class:"mt-2"},Ia={class:"text-caption",style:{color:"#999","margin-top":"8px"}},Ha={class:"text-caption mb-3",style:{color:"#666"}},Ja={style:{"text-align":"right"}},Ga={style:{"text-align":"right"}},Ka={style:{"text-align":"right"}},Qa={style:{"text-align":"right"}},Ya={style:{"text-align":"right"}},Xa={style:{"text-align":"right"}},Za={style:{"font-weight":"400"}},eo={style:{"text-align":"right",width:"120px"}},to={style:{"font-weight":"400"}},lo={style:{display:"flex","justify-content":"space-between","align-items":"center","margin-bottom":"16px"}},ao={key:0,class:"text-subtitle-2"},oo={key:0,class:"text-caption text-grey mb-3"},so={key:0,class:"text-caption text-grey mb-3"},no={key:0},io={class:"text-caption mt-1"},ro={key:1},uo=ql({__name:"ProjectEditorView",setup(Ce){const p=Ll().params.id,i=c({id:0,number:"",expert_name:"",address:"",region_id:null,waste_coefficient:1,repair_coefficient:1,text_blocks:[],normohour_rate:null,normohour_region:null,normohour_date:null,normohour_method:null,normohour_justification:null}),I=l=>{let e=l.replace(/<[^>]*>/g,"");return e=e.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"),e=e.split(`
`).map(t=>t.replace(/[ \t]+/g," ").trim()).filter(t=>t.length>0).join(`
`),e},Be=l=>l.replace(/\r\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/\u00A0/g," ").split(`
`).map(e=>e.replace(/[ \t]+/g," ").trim()).filter(e=>e.length>0).join(`
`).trim(),lt=l=>{try{let e=l;e=e.replace(/<\/?(p|div|br\s*\/?|li|ul|ol|h[1-6])>/gi,`
`),e=e.replace(/<a[^>]*>(.*?)<\/a>/gi,"$1"),e=e.replace(/<[^>]*>/g,"");const t=document.createElement("textarea");return t.innerHTML=e,e=t.value,e=e.replace(/\r\n/g,`
`).replace(/\n{3,}/g,`

`).replace(/[ \t]+/g," ").trim(),e}catch(e){return console.error("Error cleaning HTML:",e),l.replace(/<[^>]*>/g,"").trim()}},Nt=(l,e)=>{try{e.preventDefault();const t=e.clipboardData;if(!t){console.warn("Clipboard data not available");return}let n="";const r=t.getData("text/html");if(r&&r.trim().length>0?(n=lt(r),console.log("ðŸ“‹ Pasted from HTML")):(n=t.getData("text/plain")||t.getData("text")||"",console.log("ðŸ“‹ Pasted from plain text")),!n.trim()){console.warn("No text to paste");return}const v=Be(n);l.text=(l.text?l.text+`

`:"")+v,l.text=I(l.text),console.log("âœ… Paste successful. Text length:",l.text.length)}catch(t){console.error("âŒ Error during paste:",t);try{const n=e.clipboardData?.getData("text/plain")||"";if(n.trim()){const r=Be(n);l.text=(l.text?l.text+`

`:"")+r,l.text=I(l.text),console.log("âœ… Paste (fallback) successful. Text length:",l.text.length)}}catch(n){console.error("Fallback paste also failed:",n)}}},A=c([]),at=c([]),Z=c([]),Fe=c(!1),$e=c(!1),ue=c({show:!1,message:"",color:"info",timeout:3e3}),k=(l,e="info",t=3e3)=>{ue.value={show:!0,message:l,color:e,timeout:t}},F=c({positions:!1,materials:!1,fittings:!1,expenses:!1,normohourSources:!1,laborWorks:!1,operations:!1}),At=()=>{console.log("ðŸ”’ Closing settings drawer"),$e.value=!1},Mt=()=>{console.log("ðŸ”“ Opening settings drawer. Text blocks:",i.value.text_blocks),$e.value=!0},H=c([]),E=c([]),ge=c([]),ot=c([]),qt=P(()=>E.value.filter(l=>l.type==="plate")),Lt=P(()=>E.value.filter(l=>l.type==="edge")),Tt=[{title:"Ð¢Ð¸Ð¿ Ð´ÐµÑ‚Ð°Ð»Ð¸",key:"detail_type"},{title:"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»",key:"material"},{title:"ÐšÑ€Ð¾Ð¼ÐºÐ°",key:"edge_material"},{title:"ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚Ð¾Ñ€Ñ†Ð¾Ð²",key:"edge_scheme"},{title:"Ð¨Ð¸Ñ€Ð¸Ð½Ð°, Ð¼Ð¼",key:"width"},{title:"Ð”Ð»Ð¸Ð½Ð°, Ð¼Ð¼",key:"length"},{title:"ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ð¾Ð´Ð½Ð¾Ð¹ (Ð¼Â²)",key:"area_single"},{title:"ÐšÐ¾Ð»-Ð²Ð¾",key:"quantity"},{title:"ÐžÐ±Ñ‰Ð°Ñ Ð¿Ð»Ð¾Ñ‰Ð°Ð´ÑŒ (Ð¼Â²)",key:"area_total"},{title:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",key:"actions",sortable:!1}],Pt=[{title:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ",key:"name"},{title:"ÐšÐ¾Ð»-Ð²Ð¾",key:"quantity"},{title:"Ð¦ÐµÐ½Ð°",key:"unit_price"},{title:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",key:"actions",sortable:!1}],st=[{title:"",key:"data-table-expand"},{title:"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»",key:"name"},{title:"ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹ (Ð¼Â²)",key:"area_details"},{title:"ÐšÐ¾ÑÑ„Ñ„.",key:"waste_coeff"},{title:"ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ñ Ð¾Ñ‚Ñ…Ð¾Ð´Ð°Ð¼Ð¸ (Ð¼Â²)",key:"area_with_waste"},{title:"Ð Ð°Ð·Ð¼ÐµÑ€ Ð»Ð¸ÑÑ‚Ð° (Ð¼Â²)",key:"sheet_area"},{title:"Ð›Ð¸ÑÑ‚Ð¾Ð²",key:"sheets_count"},{title:"Ð¦ÐµÐ½Ð° Ð·Ð° Ð»Ð¸ÑÑ‚",key:"price_per_sheet"},{title:"Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼Â² (Ñ€Ð°ÑÑ‡.)",key:"price_per_m2",render:l=>"Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼Â² (Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð½Ð°Ñ)"},{title:"Ð¡ÑƒÐ¼Ð¼Ð°",key:"total_price"}],Et=P(()=>i.value?.use_area_calc_mode===!0?st.filter(e=>e.key!=="sheet_area"&&e.key!=="price_per_sheet").map(e=>e.key==="sheets_count"?{...e,title:"ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ðµ (Ð¼Â²)"}:e):st.filter(e=>e.key!=="price_per_m2")),St=()=>{if(!(i.value?.apply_waste_to_plate!==!1))return console.log("getWasteCoefficientForPlate: DISABLED â†’ returning 1.0"),1;const e=i.value?.waste_plate_coefficient,t=i.value?.waste_coefficient||1,n=e?Number(e):t;return console.log(`getWasteCoefficientForPlate: ENABLED â†’ ${n} (${e?"plate-specific":"general"})`),n},nt=()=>{if(!(i.value?.apply_waste_to_edge!==!1))return console.log("getWasteCoefficientForEdge: DISABLED â†’ returning 1.0"),1;const e=i.value?.waste_edge_coefficient,t=i.value?.waste_coefficient||1,n=e?Number(e):t;return console.log(`getWasteCoefficientForEdge: ENABLED â†’ ${n} (${e?"edge-specific":"general"})`),n},Ot=[{title:"",key:"data-table-expand"},{title:"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» ÐºÑ€Ð¾Ð¼ÐºÐ¸",key:"name"},{title:"Ð”Ð»Ð¸Ð½Ð° (Ð¼.Ð¿.)",key:"length_linear"},{title:"ÐšÐ¾ÑÑ„Ñ„.",key:"waste_coeff"},{title:"Ð”Ð»Ð¸Ð½Ð° Ñ Ð¾Ñ‚Ñ…Ð¾Ð´Ð°Ð¼Ð¸ (Ð¼.Ð¿.)",key:"length_with_waste"},{title:"Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼.Ð¿.",key:"price_per_unit"},{title:"Ð¡ÑƒÐ¼Ð¼Ð°",key:"total_price"}],zt=[{title:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ",key:"name"},{title:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",key:"description"},{title:"Ð¡ÑƒÐ¼Ð¼Ð°",key:"amount"},{title:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",key:"actions",sortable:!1}],it=[{value:"none",label:"Ð‘ÐµÐ· Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸",icon:"mdi-minus"},{value:"O",label:"Ð’ÐºÑ€ÑƒÐ³ (O)",icon:"mdi-circle-outline"},{value:"=",label:"ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾ Ð´Ð»Ð¸Ð½Ðµ (=)",icon:"mdi-arrow-left-right"},{value:"||",label:"ÐŸÐ°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾ ÑˆÐ¸Ñ€Ð¸Ð½Ðµ (||)",icon:"mdi-arrow-up-down"},{value:"L",label:"Ð“-Ð¾Ð±Ñ€Ð°Ð·Ð½Ð¾ (L)",icon:"mdi-vector-square"},{value:"ÐŸ",label:"ÐŸ-Ð¾Ð±Ñ€Ð°Ð·Ð½Ð¾ (ÐŸ)",icon:"mdi-alpha-p-box-outline"}],de=c(!1),me=c(!1),pe=c(!1),Ue=c(!1),Ie=c(!1),He=c(!1),De=c(!1),je=c(!1),Ne=c(!1),Je=c(!1),ee=c(null),N=c({title:"",text:""}),Ae=c([]),b=c({source:"",position_profile:null,salary_range:null,period:null,link:null,note:null}),R=c({}),rt=c(),y=c({id:null,project_id:p,detail_type_id:null,material_id:null,edge_material_id:null,edge_scheme:"none",width:0,length:0,quantity:1,custom_name:null}),$=c({id:0,project_id:p,name:"",article:"",unit:"ÑˆÑ‚",quantity:1,unit_price:0,note:""}),S=c({id:0,project_id:p,type:"",cost:0}),ut=l=>{if(!l)return"â€”";const e=E.value.find(t=>t.id===l);return e?e.name:`ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» #${l}`},dt=l=>{if(!l)return"â€”";const e=H.value.find(t=>t.id===l);return e?e.name:`Ð¢Ð¸Ð¿ #${l}`},Ge=l=>l?it.find(e=>e.value===l)?.label||l:"â€”",Wt=l=>{if(l.edge_scheme)return Ge(l.edge_scheme);if(l.detail_type_id){const e=H.value.find(t=>t.id===l.detail_type_id);if(e&&e.edge_processing)return Ge(e.edge_processing)}return"â€”"},mt=l=>{const e=[];return A.value.forEach(t=>{if(!t.edge_material_id||t.edge_material_id!==l||!t.edge_scheme||t.edge_scheme==="none")return;const n=(t.width||0)/1e3,r=(t.length||0)/1e3;let v=0;switch(t.edge_scheme){case"O":v=2*(n+r);break;case"=":v=2*r;break;case"||":v=2*n;break;case"L":v=n+r;break;case"ÐŸ":v=2*n+r;break}const f=v*(t.quantity||0);e.push({position_id:t.id,position_name:t.custom_name||dt(t.detail_type_id)||`ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ñ ${t.id}`,width:t.width,length:t.length,edge_scheme_label:Ge(t.edge_scheme),perimeter_one:v,quantity:t.quantity,total_length:f})}),e},Rt=l=>{if(!l){y.value.edge_scheme="none";return}const e=H.value.find(t=>t.id===l);e&&e.edge_processing&&(y.value.edge_scheme=e.edge_processing),ye()},U=l=>{if(l._cached_details)return l._cached_details;const e=l.name||"";return e.toLowerCase().includes("ÐºÑ€Ð¾Ð¼Ðº")?Bt(l):e.toLowerCase().includes("Ð¿Ð¸Ð»")||e.toLowerCase().includes("Ñ€Ð°ÑÐ¿Ð¸Ð»")?It(l):e.toLowerCase().includes("ÑÐ²ÐµÑ€Ð»")||e.toLowerCase().includes("Ð¾Ñ‚Ð²ÐµÑ€ÑÑ‚")?pt(l):{type:"manual",is_manual:!0,message:"Ð’Ð²ÐµÐ´ÐµÐ½Ð¾ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"}},Bt=l=>{if(l.type==="manual")return{type:"edging",is_manual:!0,message:"Ð’Ð²ÐµÐ´ÐµÐ½Ð¾ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"};const e=[];let t=0;le.value.forEach(v=>{mt(v.id).forEach(V=>{e.push({position_name:V.position_name,material_name:v.name,length:V.total_length}),t+=V.total_length})});const n=nt(),r=t*n;return{type:"edging",details:e,total_length:t,waste_coeff:n,total_with_waste:r,unit:"Ð¼.Ð¿."}},It=l=>{if(l.type==="manual")return{type:"sawing",is_manual:!0,message:"Ð’Ð²ÐµÐ´ÐµÐ½Ð¾ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"};const e=[];let t=0;return te.value.forEach(n=>{const r=n.area_details;r>0&&(e.push({material_name:n.name,area:r}),t+=r)}),{type:"sawing",details:e,total_area:t,unit:"Ð¼Â²",note:"ÐžÐ±ÑŠÑ‘Ð¼ Ñ€Ð°ÑÐ¿Ð¸Ð»Ð¾Ð²ÐºÐ¸ ÑÑ‡Ð¸Ñ‚Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚ Ð¿Ð»Ð¾Ñ‰Ð°Ð´Ð¸ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹ Ð¿Ð»Ð¸Ñ‚Ð½Ñ‹Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²"}},pt=l=>{if(console.log("getDrillingOperationDetails called:",{name:l.name,type:l.type,quantity_from_api:l.quantity,source:l.source,operation_id:l.operation_id,positions:A.value.length,detail_types:H.value.length}),l.type==="manual")return console.log("  -> operation is manual, returning manual message"),{type:"drilling",is_manual:!0,message:"Ð’Ð²ÐµÐ´ÐµÐ½Ð¾ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð¾Ð¼"};const e=new Map;A.value.forEach(r=>{const v=E.value.find(f=>f.id===r.material_id);if(console.log("  checking position:",{material_id:r.material_id,material_type:v?.type,detail_type_id:r.detail_type_id,quantity:r.quantity}),v?.type==="plate"&&r.detail_type_id){const f=H.value.find(V=>V.id===r.detail_type_id);if(f){console.log("    -> found detailType:",f.name),e.has(r.detail_type_id)||e.set(r.detail_type_id,{detail_type_name:f.name,total_quantity:0,holes_per_piece:8});const V=e.get(r.detail_type_id);V.total_quantity+=r.quantity||1}}});const t=Array.from(e.values()).map(r=>({detail_type_name:r.detail_type_name,holes_per_piece:r.holes_per_piece,quantity:r.total_quantity,total_holes:r.holes_per_piece*r.total_quantity}));console.log("  drilling details:",t);let n=0;return t.forEach(r=>{n+=r.total_holes}),console.log("  SUMMARY:",{calculated_total:n,api_quantity:l.quantity,difference:l.quantity-n,details_count:t.length}),{type:"drilling",is_manual:!1,details:t,total_holes:n,unit:"ÑˆÑ‚.",message:"Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑÐ¼ Ñ Ð¿Ð»Ð¸Ñ‚Ð½Ñ‹Ð¼Ð¸ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°Ð¼Ð¸"}};let Ke=null;const ye=()=>{Ke&&clearTimeout(Ke),Ke=setTimeout(()=>ct(),350)},ct=async()=>{try{F.value.operations=!0;const e=(await _.get(`/api/projects/${p}/operations`)).data||[];Array.isArray(e)?Me.value=e:(console.warn("Operations data is not an array:",e),Me.value=[])}catch(l){console.warn("Recalc operations failed",l),Me.value=[]}finally{F.value.operations=!1}},Ht=l=>{y.value.material_id=l,ye()},Jt=l=>{y.value.edge_scheme=l||"none",ye()},Gt=l=>{y.value.edge_material_id=l,ye()},_t=async()=>{try{F.value.materials=!0;const[l,e,t,n,r,v]=await Promise.all([_.get("/api/detail-types").then(f=>f.data),_.get("/api/materials").then(f=>f.data),_.get("/api/operations").then(f=>f.data),_.get("/api/units").then(f=>f.data),_.get("/api/regions").then(f=>f.data?.data||[]),_.get("/api/position-profiles").then(f=>f.data?.data||[])]);H.value=l,E.value=e,console.log("Materials loaded:",e.length,"samples:",e.slice(0,2)),yt.value=t,ge.value=n||[],ot.value=r,bt.value=v,console.log("Position profiles loaded:",v.length,"profiles:",v.map(f=>({id:f.id,name:f.name}))),console.log("Regions loaded:",r.length,"samples:",r.slice(0,3))}finally{F.value.materials=!1}},L=async()=>{try{F.value.positions=!0,F.value.fittings=!0,F.value.expenses=!0,i.value=(await _.get(`/api/projects/${p}`)).data;const l=i.value.profileRates;if(console.log("âœ… Project loaded:",{id:i.value.id,name:i.value.number,hasProfileRates:!!l,profileRatesCount:Array.isArray(l)?l.length:0,profileRatesType:typeof l}),l&&l.length>0&&console.log("ðŸ“Š First profileRate structure:",JSON.stringify(l[0],null,2)),i.value.use_area_calc_mode=i.value.use_area_calc_mode===!0||i.value.use_area_calc_mode===1,i.value.apply_waste_to_plate=i.value.apply_waste_to_plate!==!1&&i.value.apply_waste_to_plate!==0,i.value.apply_waste_to_edge=i.value.apply_waste_to_edge!==!1&&i.value.apply_waste_to_edge!==0,i.value.apply_waste_to_operations=i.value.apply_waste_to_operations!==!1&&i.value.apply_waste_to_operations!==0,i.value.normohour_rate=Number(i.value.normohour_rate)||0,i.value.waste_coefficient=Number(i.value.waste_coefficient)||1,i.value.waste_plate_coefficient=i.value.waste_plate_coefficient?Number(i.value.waste_plate_coefficient):null,i.value.waste_edge_coefficient=i.value.waste_edge_coefficient?Number(i.value.waste_edge_coefficient):null,i.value.waste_operations_coefficient=i.value.waste_operations_coefficient?Number(i.value.waste_operations_coefficient):null,i.value.repair_coefficient=Number(i.value.repair_coefficient)||1,i.value.show_waste_plate_description=i.value.show_waste_plate_description===!0||i.value.show_waste_plate_description===1,i.value.show_waste_edge_description=i.value.show_waste_edge_description===!0||i.value.show_waste_edge_description===1,i.value.show_waste_operations_description=i.value.show_waste_operations_description===!0||i.value.show_waste_operations_description===1,!i.value.text_blocks)i.value.text_blocks=[];else if(typeof i.value.text_blocks=="string")try{const t=JSON.parse(i.value.text_blocks);Array.isArray(t)&&t.length>0&&typeof t[0]=="string"?i.value.text_blocks=t.map(n=>({title:"",text:n||"",enabled:!0})):Array.isArray(t)?i.value.text_blocks=t.map(n=>({...n,enabled:n.enabled===!0||n.enabled===1})):i.value.text_blocks=[]}catch{i.value.text_blocks=[]}else Array.isArray(i.value.text_blocks)&&i.value.text_blocks.length>0&&typeof i.value.text_blocks[0]=="string"&&(i.value.text_blocks=i.value.text_blocks.map(t=>({title:"",text:t||"",enabled:!0})));A.value=(await _.get(`/api/projects/${p}/positions`)).data,at.value=(await _.get(`/api/projects/${p}/fittings`)).data,Z.value=(await _.get(`/api/projects/${p}/expenses`)).data,console.log("Loaded positions:",A.value),console.log("Loaded expenses:",Z.value),Z.value&&Z.value.length>0&&console.log("First expense structure:",JSON.stringify(Z.value[0],null,2)),console.log("Available materials:",E.value.slice(0,3)),console.log("Project coefficients:",{waste_coefficient:i.value.waste_coefficient,waste_plate_coefficient:i.value.waste_plate_coefficient,waste_edge_coefficient:i.value.waste_edge_coefficient,waste_operations_coefficient:i.value.waste_operations_coefficient}),console.log("ðŸ“ Text blocks loaded:",i.value.text_blocks),await ct(),await ft(),await ve();const e=i.value.profileRates;console.log("âœ… fetchData completed, final profileRates check:",{hasProfileRates:!!e,count:Array.isArray(e)?e.length:0,rates:e?Array.isArray(e)?e.map(t=>({id:t.id,is_locked:t.is_locked,method:t.calculation_method})):[]:[]})}catch(l){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°:",l),k(`ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚: ${l.response?.data?.message||l.message}`,"error")}finally{F.value.positions=!1,F.value.fittings=!1,F.value.expenses=!1}},Kt=async()=>{Fe.value=!0;try{await Promise.all([_t(),L()])}catch(l){console.error("Refresh failed",l),k("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ","error")}finally{Fe.value=!1}},Qt=()=>{De.value=!1,y.value={id:null,project_id:p,detail_type_id:null,material_id:i.value?.default_plate_material_id||null,edge_material_id:i.value?.default_edge_material_id||null,edge_scheme:"none",width:0,length:0,quantity:1,custom_name:null},de.value=!0},Yt=l=>{if(De.value=!0,y.value={...l},!y.value.edge_scheme&&y.value.detail_type_id){const e=H.value.find(t=>t.id===y.value.detail_type_id);e&&e.edge_processing&&(y.value.edge_scheme=e.edge_processing)}de.value=!0},Xt=async()=>{const{valid:l}=await rt.value.validate();if(l)try{if(y.value.material_id){const e=E.value.find(t=>t.id===y.value.material_id);if(e&&e.type==="plate"&&(e.width_mm||e.length_mm)){const t=y.value.width||0,n=y.value.length||0,r=e.width_mm||0,v=e.length_mm||0,f=Math.max(r,v),V=Math.min(r,v);if((t>f||n>f||Math.min(t,n)>V&&Math.max(t,n)>f)&&e.width_mm&&e.length_mm&&!confirm(`âš ï¸ Ð’ÐÐ˜ÐœÐÐÐ˜Ð•!

Ð Ð°Ð·Ð¼ÐµÑ€ Ð´ÐµÑ‚Ð°Ð»Ð¸ (${t}Ã—${n} Ð¼Ð¼) Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐ°ÐµÑ‚ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð»Ð¸ÑÑ‚Ð° Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð° (${r}Ã—${v} Ð¼Ð¼).

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚ÑŒ Ð²Ð²ÐµÐ´Ñ‘Ð½Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ….

ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ?`)){console.log("Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð¾ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¼ Ð¸Ð·-Ð·Ð° Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð°");return}}}De.value?await _.put(`/api/project-positions/${y.value.id}`,y.value):await _.post(`/api/projects/${p}/positions`,y.value),de.value=!1,await L()}catch(e){console.error(e),k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸","error")}},Zt=async l=>{confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ?")&&(await _.delete(`/api/project-positions/${l.id}`),await L())},el=async l=>{try{J.value=l.id||null;const e={project_id:p,detail_type_id:l.detail_type_id,material_id:l.material_id,edge_material_id:l.edge_material_id,edge_scheme:l.edge_scheme,width:l.width,length:l.length,quantity:l.quantity,custom_name:l.custom_name};console.log("ðŸ”„ Cloning position:",e);const t=await _.post(`/api/projects/${p}/positions`,e);console.log("âœ… Position cloned successfully"),await L()}catch(e){console.error("âŒ Error cloning position:",e),k(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ð¸: ${e.response?.data?.message||e.message}`,"error")}finally{J.value=null}},Qe=async(l,e,t)=>{if(!l.id){k("Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ Ñ‡ÐµÑ€ÐµÐ· Ð´Ð¸Ð°Ð»Ð¾Ð³","warning");return}const n={};e==="width"||e==="length"?n[e]=parseFloat(t)||0:e==="quantity"?n[e]=parseInt(t)||1:n[e]=t;try{await _.put(`/api/project-positions/${l.id}`,n),ye()}catch(r){console.error(r),k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸","error"),await L()}},tl=()=>{je.value=!1;const l=ge.value[0]||"ÑˆÑ‚";$.value={id:0,project_id:p,name:"",article:"",unit:l,quantity:1,unit_price:0,note:""},me.value=!0},ll=l=>{je.value=!0;const e=ge.value[0]||"ÑˆÑ‚";$.value={...l,unit:l.unit||e,note:l.note??""},me.value=!0},al=async()=>{try{const l={name:$.value.name,article:$.value.article,unit:$.value.unit||ge.value[0]||"ÑˆÑ‚",quantity:Number($.value.quantity)||0,unit_price:Number($.value.unit_price)||0,note:$.value.note||null};je.value?await _.put(`/api/project-fittings/${$.value.id}`,l):await _.post(`/api/projects/${p}/fittings`,l),me.value=!1,await L()}catch(l){const e=l,t=e?.response?.data?.errors,n=t?Object.values(t).flat().join(`
`):e?.response?.data?.message||e?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ„ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ñ‹";k(n,"error")}},ol=async l=>{confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ñƒ?")&&(await _.delete(`/api/project-fittings/${l.id}`),await L())},sl=()=>{i.value.text_blocks||(i.value.text_blocks=[]),i.value.text_blocks.length<10&&(i.value.text_blocks.push({title:"",text:"",enabled:!0}),console.log("ðŸ“ Added new text block. Total blocks:",i.value.text_blocks.length))},nl=l=>{if(i.value.text_blocks){const e=i.value.text_blocks.splice(l,1);console.log("ðŸ“ Removed text block. Removed:",e[0],"Total blocks:",i.value.text_blocks.length)}},il=l=>{if(i.value.text_blocks&&l>0){const e=i.value.text_blocks[l];i.value.text_blocks[l]=i.value.text_blocks[l-1],i.value.text_blocks[l-1]=e,console.log("â¬†ï¸ Moved text block up. Current position:",l-1)}},rl=l=>{if(i.value.text_blocks&&l<i.value.text_blocks.length-1){const e=i.value.text_blocks[l];i.value.text_blocks[l]=i.value.text_blocks[l+1],i.value.text_blocks[l+1]=e,console.log("â¬‡ï¸ Moved text block down. Current position:",l+1)}},ul=()=>{if(!ee.value)return;const l={title:N.value.title.trim(),text:I(N.value.text)};ee.value==="plate"?l.title||l.text?(i.value.waste_plate_description=l,i.value.show_waste_plate_description=!0):(i.value.waste_plate_description=null,i.value.show_waste_plate_description=!1):ee.value==="edge"?l.title||l.text?(i.value.waste_edge_description=l,i.value.show_waste_edge_description=!0):(i.value.waste_edge_description=null,i.value.show_waste_edge_description=!1):ee.value==="operations"&&(l.title||l.text?(i.value.waste_operations_description=l,i.value.show_waste_operations_description=!0):(i.value.waste_operations_description=null,i.value.show_waste_operations_description=!1)),vt()},vt=()=>{Ie.value=!1,ee.value=null,N.value={title:"",text:""}},dl=l=>{try{l.preventDefault();const e=l.clipboardData;if(!e){console.warn("Clipboard data not available");return}let t="";const n=e?.getData("text/html");n&&n.trim().length>0?t=lt(n):t=e?.getData("text/plain")||"";const r=Be(t);N.value.text=(N.value.text?N.value.text+`

`:"")+r,N.value.text=I(N.value.text)}catch(e){console.error("Error during paste:",e)}},ft=async()=>{try{F.value.normohourSources=!0;const l=await _.get(`/api/projects/${p}/normohour-sources`);Ae.value=l.data||[],console.log("ðŸ“Š Normohour sources loaded:",Ae.value)}catch(l){console.error("âŒ Error loading normohour sources:",l),Ae.value=[]}finally{F.value.normohourSources=!1}},gt=()=>{He.value=!1,Je.value=!1,b.value={source:"",position_profile:null,salary_range:null,period:null,link:null,note:null},R.value={}},ml=()=>(R.value={},(!b.value.source||!b.value.source.trim())&&(R.value.source="Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÐµÐ½"),b.value.link&&b.value.link.trim()&&(/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/.test(b.value.link.trim())||(R.value.link="ÐÐµÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð°Ñ ÑÑÑ‹Ð»ÐºÐ°")),Object.keys(R.value).length===0),pl=async()=>{if(ml())try{const l={source:b.value.source.trim(),position_profile:b.value.position_profile?b.value.position_profile.trim():null,salary_range:b.value.salary_range?b.value.salary_range.trim():null,period:b.value.period?b.value.period.trim():null,link:b.value.link?b.value.link.trim():null,note:b.value.note?b.value.note.trim():null};if(Je.value&&b.value.id)await _.put(`/api/projects/${p}/normohour-sources/${b.value.id}`,l),console.log("âœ… Normohour source updated");else{if(Ae.value.length>=20){k("ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 20 Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð²","warning");return}await _.post(`/api/projects/${p}/normohour-sources`,l),console.log("âœ… Normohour source created")}await ft(),gt()}catch(l){console.error("âŒ Error saving normohour source:",l);const e=l.response?.data?.message||l.message;k(`ÐžÑˆÐ¸Ð±ÐºÐ°: ${e}`,"error")}},cl=async()=>{Ue.value=!0;try{const l=await _.get(`/api/smeta/pdf/${p}`,{responseType:"blob"}),e=URL.createObjectURL(l.data),t=document.createElement("a");t.href=e,t.download=`smeta_${p}.pdf`,t.click(),URL.revokeObjectURL(e)}catch(l){console.error("âŒ PDF generation error:",l),k(`ÐžÑˆÐ¸Ð±ÐºÐ° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸ PDF: ${l.response?.data?.message||l.message}`,"error")}finally{Ue.value=!1}},_l=()=>{Ne.value=!1,S.value={id:0,project_id:p,name:"",description:"",amount:0},pe.value=!0},vl=l=>{Ne.value=!0,S.value={...l},pe.value=!0},fl=async()=>{try{const l={name:S.value.name,description:S.value.description,amount:Number(S.value.amount)||0};Ne.value?await _.put(`/api/projects/${p}/expenses/${S.value.id}`,l):await _.post(`/api/projects/${p}/expenses`,l),pe.value=!1,await L()}catch(l){const e=l,t=e?.response?.data?.errors,n=t?Object.values(t).flat().join(`
`):e?.response?.data?.message||e?.message||"ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ€Ð°ÑÑ…Ð¾Ð´Ð°";k(n,"error")}},gl=async l=>{confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÑ…Ð¾Ð´?")&&(await _.delete(`/api/projects/${p}/expenses/${l.id}`),await L())},Me=c([]),Ye=c(null),J=c(null),qe=P(()=>Me.value.map(e=>{const t=e.name||"",n=t.toLowerCase().includes("ÑÐ²ÐµÑ€Ð»")||t.toLowerCase().includes("Ð¾Ñ‚Ð²ÐµÑ€ÑÑ‚"),r=e.type!=="manual"&&!e.source?.includes("manual");let v=e.quantity;if(n&&r&&e.source==="detail_type"){const f=pt(e);f.total_holes!==void 0&&(v=f.total_holes)}return{...e,quantity:v,is_manual:e.type==="manual"||e.source==="manual"||!!e.is_manual,total_cost:(v??0)*(e.cost_per_unit??0),_cached_details:U(e)}})),yt=c([]),ce=c(!1),Le=c(!1),O=c({id:0,project_id:p,operation_id:null,quantity:1,note:""}),yl=[{title:"",key:"data-table-expand"},{title:"ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ",key:"name"},{title:"ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ",key:"category"},{title:"Ð¦ÐµÐ½Ð° Ð·Ð° ÐµÐ´.",key:"cost_per_unit",align:"end"},{title:"ÐšÐ¾Ð»-Ð²Ð¾",key:"quantity_display"},{title:"Ð•Ð´. Ð¸Ð·Ð¼.",key:"unit"},{title:"Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ",key:"total_cost",align:"end"},{title:"Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº",key:"source"},{title:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",key:"actions",sortable:!1}],G=c([]),bt=c([]),_e=c(!1),Xe=c(!1),wt=c(null),be=c(null),D=c({title:"",basis:"",hours:0,note:"",position_profile_id:null}),bl=[{title:"ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ",key:"title"},{title:"ÐžÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ",key:"basis"},{title:"ÐÐ¾Ñ€Ð¼Ð°, Ñ‡",key:"hours",align:"end"},{title:"Ð¡Ñ‚Ð°Ð²ÐºÐ°, â‚½/Ñ‡",key:"rate",align:"end"},{title:"Ð¡ÑƒÐ¼Ð¼Ð°, â‚½",key:"cost",align:"end"},{title:"Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ",key:"actions",sortable:!1,width:"100px"}],we=c(!1),Te=c(!1),Pe=c(!1),xt=P(()=>Array.isArray(G.value)?G.value.reduce((l,e)=>l+(parseFloat(e.cost_total)||0),0):0),xe=P(()=>{const l=i.value.profileRates;if(typeof l<"u"&&console.log("ðŸ” ratesLocked computed:",{type:Array.isArray(l)?"array":typeof l,value:l,length:Array.isArray(l)?l.length:l&&typeof l=="object"?Object.keys(l).length:0}),!l)return!1;const e=Array.isArray(l)?l:Object.values(l||{});if(e.length===0)return!1;const t=e.every(n=>n.is_locked===!0);return console.log("ðŸ” All rates locked?",t,"out of",e.length),t});Ct(()=>i.value.normohour_rate,l=>{G.value.length>0&&(G.value=G.value.map(e=>({...e,cost:e.hours*(l||0)})))}),Ct(()=>i.value.profileRates,l=>{console.log("ðŸ‘€ profileRates changed:",{count:l?Array.isArray(l)?l.length:Object.keys(l).length:0,rates:l?Array.isArray(l)?l.map(e=>({id:e.id,is_locked:e.is_locked})):Object.values(l).map(e=>({id:e.id,is_locked:e.is_locked})):[]})},{deep:!0}),P(()=>{try{if(!A.value||A.value.length===0)return[];const l=new Map;return A.value.forEach(e=>{if(!e.material_id)return;const t=E.value.find(v=>v.id===e.material_id);if(!t)return;const n=(e.width||0)/1e3*((e.length||0)/1e3)*(e.quantity||0);if(!l.has(e.material_id)){const v=t.price_per_unit||0;let f=v;if(t.type==="plate"&&t.length_mm&&t.width_mm){const V=t.length_mm*t.width_mm/1e6;V>0&&(f=v/V)}l.set(e.material_id,{id:e.material_id,name:t.name,volume:0,unit:t.unit||"Ð¼Â²",price_per_unit:f,price_per_sheet:v,updated_at:t.updated_at})}const r=l.get(e.material_id);r.volume+=n}),Array.from(l.values())}catch(l){return console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²:",l),[]}});const te=P(()=>{try{if(!A.value||A.value.length===0)return console.log("plateData: no positions"),[];const l=St(),e=new Map;A.value.forEach(n=>{if(!n.material_id)return;const r=E.value.find(V=>V.id===n.material_id);if(!r){console.warn("Material not found:",n.material_id);return}if(console.log("Material check:",{id:r.id,name:r.name,type:r.type,isPlate:r.type==="plate"}),r.type!=="plate"){console.log("Skipping non-plate material:",r.name,"type:",r.type);return}const v=(n.width||0)/1e3*((n.length||0)/1e3)*(n.quantity||0);if(!e.has(n.material_id)){const V=r.length_mm&&r.width_mm?r.length_mm*r.width_mm/1e6:0;e.set(n.material_id,{id:n.material_id,name:r.name,area_details:0,waste_coeff:l,area_with_waste:0,sheet_area:V,sheets_count:0,price_per_sheet:r.price_per_unit||0,price_per_m2:r.price_per_unit&&V>0?r.price_per_unit/V:0,updated_at:r.updated_at,source_url:r.source_url})}const f=e.get(n.material_id);f.area_details+=v});const t=i.value?.use_area_calc_mode===!0;return e.forEach(n=>{n.area_with_waste=n.area_details*l,t?n.sheets_count=0:n.sheets_count=n.sheet_area>0?Math.ceil(n.area_with_waste/n.sheet_area):0}),console.log("plateData result:",Array.from(e.values()),"area mode:",t),Array.from(e.values())}catch(l){return console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ Ð¿Ð»Ð¸Ñ‚Ð½Ñ‹Ñ… Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð¾Ð²:",l),[]}}),le=P(()=>{try{if(!A.value||A.value.length===0)return[];const l=nt(),e=new Map;return A.value.forEach(t=>{if(!t.edge_material_id||!t.edge_scheme||t.edge_scheme==="none")return;const n=E.value.find(Vt=>Vt.id===t.edge_material_id);if(!n||n.type!=="edge")return;let r=0;const v=(t.width||0)/1e3,f=(t.length||0)/1e3,V=t.quantity||0;switch(t.edge_scheme){case"O":r=2*(v+f)*V;break;case"=":r=2*f*V;break;case"||":r=2*v*V;break;case"L":r=(v+f)*V;break;case"ÐŸ":r=(2*v+f)*V;break;default:r=0}e.has(t.edge_material_id)||e.set(t.edge_material_id,{id:t.edge_material_id,name:n.name,length_linear:0,waste_coeff:l,length_with_waste:0,price_per_unit:n.price_per_unit||0,updated_at:n.updated_at});const kt=e.get(t.edge_material_id);kt.length_linear+=r}),e.forEach(t=>{t.length_with_waste=t.length_linear*l}),Array.from(e.values())}catch(l){return console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ñ‹Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ñ ÐºÑ€Ð¾Ð¼ÐºÐ¸:",l),[]}}),wl=P(()=>{if(!te.value||te.value.length===0)return 0;const l=i.value?.use_area_calc_mode===!0;return te.value.reduce((e,t)=>{const n=l?t.area_with_waste*(Number(t.price_per_m2)||0):t.sheets_count*(Number(t.price_per_sheet)||0);return e+n},0)}),xl=P(()=>!le.value||le.value.length===0?0:le.value.reduce((l,e)=>l+e.length_with_waste*(Number(e.price_per_unit)||0),0)),hl=P(()=>(wl.value||0)+(xl.value||0)),kl=P(()=>!qe.value||qe.value.length===0?0:qe.value.reduce((l,e)=>{const t=parseFloat(e.total_cost??(e.quantity||0)*(e.cost_per_unit||0))||0;return l+t},0)),Vl=()=>{Le.value=!1,O.value={id:0,project_id:p,operation_id:null,quantity:1,note:""},ce.value=!0},Cl=async()=>{try{const l={quantity:Number(O.value.quantity)||0,note:O.value.note||null},e=O.value.operation_id;l.operation_id=e&&typeof e=="object"?e.id:e,Le.value?await _.put(`/api/project-operations/${O.value.id}`,l):await _.post(`/api/projects/${p}/operations`,l),ce.value=!1,await L()}catch(l){console.error("saveOperation error",l),k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸: "+(l.response?.data?.message||l.message),"error")}},Fl=l=>{Le.value=!0,O.value={...l},ce.value=!0},$l=async l=>{if(confirm("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ?"))try{await _.delete(`/api/project-operations/${l.id}`),await L()}catch{k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸","error")}},Ul=async()=>{Te.value=!0;try{const l=await _.post(`/api/projects/${p}/profile-rates/recalculate-and-fix`,{method:"median",only_if_missing:!1});if(l.data.success){await ve(),we.value=!1,console.log("âœ… Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿ÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ð°Ð½Ñ‹ Ð¸ Ð·Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",l.data.data);const e=l.data.data.created_rate_ids?.length??0;k(`Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿ÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ð°Ð½Ñ‹ Ð¸ Ð·Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ (${e} ÑÑ‚Ð°Ð²Ð¾Ðº ÑÐ¾Ð·Ð´Ð°Ð½Ð¾)`,"success")}else console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÐµÑÑ‡ÐµÑ‚Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº:",l.data.message),k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÐµÑÑ‡ÐµÑ‚Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº: "+l.data.message,"error")}catch(l){console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ° Ð¿ÐµÑ€ÐµÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð°Ð²Ð¾Ðº:",l);try{await ve(),k("Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹, Ð½Ð¾ Ñ„Ð¸ÐºÑÐ°Ñ†Ð¸Ñ ÑÑ‚Ð°Ð²Ð¾Ðº Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð°","warning")}catch{k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿ÐµÑ€ÐµÑÑ‡ÐµÑ‚Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº: "+(l.response?.data?.message||l.message),"error")}}finally{Te.value=!1}},Dl=async()=>{Pe.value=!0;try{if(xe.value){console.log("ðŸ”“ Ð Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº...");const e=await _.post(`/api/projects/${p}/profile-rates/unlock`,{});if(e.data.success){console.log("ï¿½ ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ°..."),await L(),console.log("âœ… Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",e.data.data);const t=e.data.data.unlocked_count??0;k(`Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ (${t} ÑÑ‚Ð°Ð²Ð¾Ðº Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾)`,"success")}else console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ ÑÑ‚Ð°Ð²Ð¾Ðº:",e.data.message),k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ñ€Ð°Ð·Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ ÑÑ‚Ð°Ð²Ð¾Ðº: "+e.data.message,"error")}else{console.log("ðŸ“Œ Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ/Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº Ð¿ÐµÑ€ÐµÐ´ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¾Ð¹...");const e=await _.post(`/api/projects/${p}/profile-rates/recalculate-and-fix`,{method:"median",only_if_missing:!1});if(!e.data.success){k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐµ ÑÑ‚Ð°Ð²Ð¾Ðº Ðº Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ: "+e.data.message,"error");return}console.log("âœ… Ð¡Ñ‚Ð°Ð²ÐºÐ¸ Ð¿Ð¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ðº Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ"),console.log("ðŸ”’ Ð‘Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð²Ð¾Ðº...");const t=await _.post(`/api/projects/${p}/profile-rates/lock`,{});if(t.data.success){console.log("ðŸ”„ ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸..."),await L(),console.log("âœ… Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹",t.data.data);const n=t.data.data.locked_count??0;k(`Ð¡Ñ‚Ð°Ð²ÐºÐ¸ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ (${n} ÑÑ‚Ð°Ð²Ð¾Ðº Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾)`,"success")}else console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ ÑÑ‚Ð°Ð²Ð¾Ðº:",t.data.message),k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐµ ÑÑ‚Ð°Ð²Ð¾Ðº: "+t.data.message,"error")}}catch(l){console.error("âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ ÑÑ‚Ð°Ð²Ð¾Ðº:",l);try{await ve(),k("Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ñ‹, Ð½Ð¾ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð¿Ñ€Ð¾ÑˆÐ»Ð°: "+(l.response?.data?.message||l.message),"warning")}catch{k("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¸ ÑÑ‚Ð°Ñ‚ÑƒÑÐ° Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²ÐºÐ¸ ÑÑ‚Ð°Ð²Ð¾Ðº: "+(l.response?.data?.message||l.message),"error")}}finally{Pe.value=!1}},jl=()=>{be.value=null,D.value={title:"",basis:"",hours:0,note:"",position_profile_id:null},_e.value=!0},ht=async()=>{try{if(!wt.value?.validate())return;Xe.value=!0;const l={title:D.value.title||"",basis:D.value.basis||null,hours:parseFloat(String(D.value.hours))||0,note:D.value.note||null,position_profile_id:D.value.position_profile_id||null};be.value?.id?await Ve.update(Number(p),be.value.id,l):await Ve.create(Number(p),{project_id:Number(p),...l}),_e.value=!1,await ve()}catch(l){console.error("saveLaborWork error",l),k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹: "+(l.response?.data?.message||l.message),"error")}finally{Xe.value=!1}},Nl=l=>{be.value=l,D.value={title:l.title,basis:l.basis||"",hours:l.hours,note:l.note||"",position_profile_id:l.position_profile_id||null},_e.value=!0},Al=async l=>{if(confirm(`Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ "${l.title}"?`))try{await Ve.delete(Number(p),l.id),await ve()}catch(e){console.error("deleteLaborWork error",e),k("ÐžÑˆÐ¸Ð±ÐºÐ° ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹: "+(e.response?.data?.message||e.message),"error")}},ve=async()=>{try{F.value.laborWorks=!0;const l=await _.post(`/api/projects/${p}/labor-works/recalculate`,{mode:"preview"});if(l.data.success&&l.data.data.works)l.data.data.works.length>0&&(console.log("ðŸ“‹ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿ÐµÑ€Ð²Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:",l.data.data.works[0]),console.log("ðŸ“‹ Ð’ÑÐµ ÐºÐ»ÑŽÑ‡Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:",Object.keys(l.data.data.works[0]))),G.value=l.data.data.works.map(e=>({...e,cost:e.cost_total??e.hours*(e.rate_per_hour||0)})),we.value=l.data.data.has_missing_rates??!1,l.data.data.has_missing_rates&&console.warn("âš ï¸ Ð•ÑÑ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð±ÐµÐ· Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ñ‹Ñ… ÑÑ‚Ð°Ð²Ð¾Ðº (Ð½ÐµÑ‚ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð²)");else{const e=await Ve.getAll(Number(p));G.value=(e||[]).map(t=>{const n=t.rate_per_hour??(i.value.normohour_rate||0);return{...t,cost:t.cost_total??t.hours*n}}),we.value=!1}}catch(l){console.error("loadLaborWorks error",l),we.value=!1;try{const e=await Ve.getAll(Number(p));G.value=(e||[]).map(t=>{const n=t.rate_per_hour??(i.value.normohour_rate||0);return{...t,cost:t.cost_total??t.hours*n}})}catch(e){console.error("loadLaborWorks fallback error",e)}}finally{F.value.laborWorks=!1}},Ml=()=>{window.open("/detail-types","_blank");const l=setInterval(async()=>{try{const e=await _.get("/api/detail-types").then(t=>t.data);H.value=e}catch(e){console.error("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ñ‚Ð¸Ð¿Ð¾Ð² Ð´ÐµÑ‚Ð°Ð»Ð¸:",e)}},2e3);setTimeout(()=>clearInterval(l),300*1e3)};return Tl(async()=>{await _t(),await L()}),(l,e)=>(m(),x(K,null,[a(Oe,{class:"pa-0"},{default:o(()=>[a(Sl,{color:"primary",dark:"",class:"mb-4"},{default:o(()=>[a(Ol,null,{default:o(()=>[d("ÐŸÑ€Ð¾ÐµÐºÑ‚ #"+u(i.value.number),1)]),_:1}),a(B),a(h,{size:"small",color:"secondary","prepend-icon":"mdi-refresh",loading:Fe.value,disabled:Fe.value,onClick:Kt,class:"mr-2"},{default:o(()=>[...e[69]||(e[69]=[d(" ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ ",-1)])]),_:1},8,["loading","disabled"]),a(h,{size:"small","prepend-icon":"mdi-cog",onClick:Mt},{default:o(()=>[...e[70]||(e[70]=[d(" ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ",-1)])]),_:1})]),_:1}),a(zl,{"model-value":$e.value,"onUpdate:modelValue":e[18]||(e[18]=t=>$e.value=t),location:"right",width:"1000",temporary:"",elevation:"16",class:"settings-drawer"},{default:o(()=>[a(Q,{class:"h-100 rounded-0"},{default:o(()=>[a(M,{class:"pa-4 border-b"},{default:o(()=>[s("div",Jl,[e[72]||(e[72]=s("span",null,"ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",-1)),a(h,{icon:"",variant:"text",size:"small",onClick:oe(At,["stop"])},{default:o(()=>[a(j,null,{default:o(()=>[...e[71]||(e[71]=[d("mdi-close",-1)])]),_:1})]),_:1})])]),_:1}),a(Y,{class:"pa-4 overflow-y-auto",style:{height:"calc(100vh - 100px)"}},{default:o(()=>[a(Ze,null,{default:o(()=>[s("div",Gl,[e[73]||(e[73]=s("h3",{class:"text-subtitle-1 mb-3"},"ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ðµ",-1)),a(w,{modelValue:i.value.number,"onUpdate:modelValue":e[0]||(e[0]=t=>i.value.number=t),label:"â„– Ð´ÐµÐ»Ð°",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:i.value.expert_name,"onUpdate:modelValue":e[1]||(e[1]=t=>i.value.expert_name=t),label:"Ð¤Ð˜Ðž ÑÐºÑÐ¿ÐµÑ€Ñ‚Ð°",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:i.value.address,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value.address=t),label:"ÐÐ´Ñ€ÐµÑ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°",class:"mb-3"},null,8,["modelValue"]),a(X,{modelValue:i.value.region_id,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.region_id=t),items:ot.value,"item-title":"name","item-value":"id",label:"Ð ÐµÐ³Ð¸Ð¾Ð½",clearable:"",density:"compact",class:"mb-3",hint:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ³Ð¸Ð¾Ð½ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð°Ð²Ð¾Ðº","menu-props":{maxHeight:300}},null,8,["modelValue","items"])]),a(z,{class:"my-4"}),s("div",Kl,[e[76]||(e[76]=s("h3",{class:"text-subtitle-1 mb-3"},"ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ñ‹",-1)),a(w,{modelValue:i.value.waste_coefficient,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.waste_coefficient=t),modelModifiers:{number:!0},label:"ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¾Ð±Ñ€ÐµÐ·ÐºÐ¾Ð²",type:"number",min:"1",step:"0.01",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:i.value.repair_coefficient,"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.repair_coefficient=t),modelModifiers:{number:!0},label:"Ð ÐµÐ¼Ð¾Ð½Ñ‚Ð½Ñ‹Ð¹ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚",type:"number",min:"1",step:"0.01",class:"mb-3"},null,8,["modelValue"]),s("div",Ql,[e[74]||(e[74]=s("span",{class:"text-subtitle-2"},"ÐŸÐ¾ Ð»Ð¸ÑÑ‚Ð°Ð¼",-1)),a(Dt,{modelValue:i.value.use_area_calc_mode,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.use_area_calc_mode=t)},null,8,["modelValue"]),e[75]||(e[75]=s("span",{class:"text-subtitle-2"},"ÐŸÐ¾ Ð¿Ð»Ð¾Ñ‰Ð°Ð´Ð¸",-1))])]),a(z,{class:"my-4"}),s("div",Yl,[e[77]||(e[77]=s("h3",{class:"text-subtitle-1 mb-3"},"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ",-1)),a(X,{modelValue:i.value.default_plate_material_id,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.default_plate_material_id=t),items:E.value.filter(t=>t.type==="plate"),"item-title":"name","item-value":"id",label:"ÐŸÐ»Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»",clearable:"",density:"compact",class:"mb-3"},null,8,["modelValue","items"]),a(X,{modelValue:i.value.default_edge_material_id,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.default_edge_material_id=t),items:E.value.filter(t=>t.type==="edge"),"item-title":"name","item-value":"id",label:"ÐšÑ€Ð¾Ð¼Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»",clearable:"",density:"compact"},null,8,["modelValue","items"])]),a(z,{class:"my-4"}),s("div",Xl,[e[82]||(e[82]=s("h3",{class:"text-subtitle-1 mb-3"},"ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ñ‹ Ð¾Ñ‚Ñ…Ð¾Ð´Ð¾Ð²",-1)),a(ke,{class:"border",density:"compact"},{default:o(()=>[e[81]||(e[81]=s("thead",null,[s("tr",null,[s("th",null,"Ð¢Ð¸Ð¿"),s("th",null,"Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ"),s("th",null,"ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÑ‚ÑŒ")])],-1)),s("tbody",null,[s("tr",null,[e[78]||(e[78]=s("td",null,"ÐŸÐ»Ð¸Ñ‚Ð½Ñ‹Ðµ",-1)),s("td",null,[a(w,{modelValue:i.value.waste_plate_coefficient,"onUpdate:modelValue":e[9]||(e[9]=t=>i.value.waste_plate_coefficient=t),modelModifiers:{number:!0},type:"number",step:"0.01",min:"1",density:"compact","hide-details":"",style:{"max-width":"100px"},placeholder:String(i.value.waste_coefficient||1.2)},null,8,["modelValue","placeholder"])]),s("td",null,[a(et,{modelValue:i.value.apply_waste_to_plate,"onUpdate:modelValue":e[10]||(e[10]=t=>i.value.apply_waste_to_plate=t),"hide-details":"",class:"mt-0"},null,8,["modelValue"])])]),s("tr",null,[e[79]||(e[79]=s("td",null,"ÐšÑ€Ð¾Ð¼ÐºÐ°",-1)),s("td",null,[a(w,{modelValue:i.value.waste_edge_coefficient,"onUpdate:modelValue":e[11]||(e[11]=t=>i.value.waste_edge_coefficient=t),modelModifiers:{number:!0},type:"number",step:"0.01",min:"1",density:"compact","hide-details":"",style:{"max-width":"100px"},placeholder:String(i.value.waste_coefficient||1.1)},null,8,["modelValue","placeholder"])]),s("td",null,[a(et,{modelValue:i.value.apply_waste_to_edge,"onUpdate:modelValue":e[12]||(e[12]=t=>i.value.apply_waste_to_edge=t),"hide-details":"",class:"mt-0"},null,8,["modelValue"])])]),s("tr",null,[e[80]||(e[80]=s("td",null,"ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¸",-1)),s("td",null,[a(w,{modelValue:i.value.waste_operations_coefficient,"onUpdate:modelValue":e[13]||(e[13]=t=>i.value.waste_operations_coefficient=t),modelModifiers:{number:!0},type:"number",step:"0.01",min:"1",density:"compact","hide-details":"",style:{"max-width":"100px"},placeholder:String(i.value.waste_coefficient||1)},null,8,["modelValue","placeholder"])]),s("td",null,[a(et,{modelValue:i.value.apply_waste_to_operations,"onUpdate:modelValue":e[14]||(e[14]=t=>i.value.apply_waste_to_operations=t),"hide-details":"",class:"mt-0"},null,8,["modelValue"])])])])]),_:1})]),a(z,{class:"my-4"}),s("div",Zl,[e[83]||(e[83]=s("h3",{class:"text-subtitle-1 mb-3"},"ÐÐ¾Ñ€Ð¼Ð¾-Ñ‡Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚",-1)),a(w,{modelValue:i.value.normohour_rate,"onUpdate:modelValue":e[15]||(e[15]=t=>i.value.normohour_rate=t),modelModifiers:{number:!0},label:"Ð¡Ñ‚Ð°Ð²ÐºÐ°, Ñ€ÑƒÐ±/Ñ‡Ð°Ñ",type:"number",step:"0.01",min:"0",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 734",density:"compact",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:i.value.normohour_region,"onUpdate:modelValue":e[16]||(e[16]=t=>i.value.normohour_region=t),label:"Ð“Ð¾Ñ€Ð¾Ð´/Ñ€ÐµÐ³Ð¸Ð¾Ð½",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Ð•ÐºÐ°Ñ‚ÐµÑ€Ð¸Ð½Ð±ÑƒÑ€Ð³",density:"compact",maxlength:"255",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:i.value.normohour_date,"onUpdate:modelValue":e[17]||(e[17]=t=>i.value.normohour_date=t),label:"Ð”Ð°Ñ‚Ð° Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÑÑ‚Ð°Ð²ÐºÐ¸",type:"date",density:"compact"},null,8,["modelValue"])]),a(z,{class:"my-4"}),s("div",ea,[e[87]||(e[87]=s("h3",{class:"text-subtitle-1 mb-3"},"Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ñ‹Ðµ Ð±Ð»Ð¾ÐºÐ¸ ÑÐ¼ÐµÑ‚Ñ‹",-1)),i.value.text_blocks&&i.value.text_blocks.length>0?(m(),x("div",ta,[(m(!0),x(K,null,he(i.value.text_blocks,(t,n)=>(m(),x("div",{key:n,class:"mb-3 pa-3 border rounded",style:Ft({"background-color":t.enabled!==!1?"rgba(0,0,0,0.02)":"rgba(0,0,0,0.01)",opacity:t.enabled!==!1?1:.6})},[s("div",la,[s("div",aa,[s("span",oa,"Ð‘Ð»Ð¾Ðº "+u(n+1),1),a(Dt,{modelValue:t.enabled,"onUpdate:modelValue":r=>t.enabled=r,title:"Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ/Ð²Ñ‹ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð±Ð»Ð¾Ðº Ð² Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ðµ"},null,8,["modelValue","onUpdate:modelValue"])]),s("div",sa,[n>0?(m(),g(h,{key:0,icon:"",size:"x-small",color:"info",variant:"text",onClick:r=>il(n),title:"ÐŸÐµÑ€ÐµÐ¼ÐµÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð²ÐµÑ€Ñ…"},{default:o(()=>[a(j,{size:"small"},{default:o(()=>[...e[84]||(e[84]=[d("mdi-arrow-up",-1)])]),_:1})]),_:1},8,["onClick"])):C("",!0),n<(i.value.text_blocks?.length||0)-1?(m(),g(h,{key:1,icon:"",size:"x-small",color:"info",variant:"text",onClick:r=>rl(n),title:"ÐŸÐµÑ€ÐµÐ¼ÐµÑÑ‚Ð¸Ñ‚ÑŒ Ð²Ð½Ð¸Ð·"},{default:o(()=>[a(j,{size:"small"},{default:o(()=>[...e[85]||(e[85]=[d("mdi-arrow-down",-1)])]),_:1})]),_:1},8,["onClick"])):C("",!0),a(h,{icon:"",size:"x-small",color:"error",variant:"text",onClick:r=>nl(n),title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð±Ð»Ð¾Ðº"},{default:o(()=>[a(j,{size:"small"},{default:o(()=>[...e[86]||(e[86]=[d("mdi-delete",-1)])]),_:1})]),_:1},8,["onClick"])])]),a(w,{modelValue:t.title,"onUpdate:modelValue":r=>t.title=r,label:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð±Ð»Ð¾ÐºÐ°",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÐžÐ±Ñ‰Ð¸Ðµ Ð¿Ñ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ, Ð“Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ",counter:"100",maxlength:"100",class:"mb-2",onInput:r=>t.title=t.title||"",disabled:t.enabled===!1},null,8,["modelValue","onUpdate:modelValue","onInput","disabled"]),a(fe,{modelValue:t.text,"onUpdate:modelValue":r=>t.text=r,label:"Ð¢ÐµÐºÑÑ‚ Ð±Ð»Ð¾ÐºÐ°",variant:"outlined",rows:"3",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ (Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 3000 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)",counter:"3000",maxlength:"3000",onInput:r=>t.text=I(t.text),onPaste:r=>Nt(t,r),disabled:t.enabled===!1,density:"compact"},null,8,["modelValue","onUpdate:modelValue","onInput","onPaste","disabled"]),t.text.length>0?(m(),x("div",na," Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¾Ð²: "+u(t.text.length)+"/3000 ",1)):C("",!0)],4))),128))])):C("",!0),!i.value.text_blocks||i.value.text_blocks.length<10?(m(),x("div",ia,[a(h,{"prepend-icon":"mdi-plus",color:"secondary",variant:"outlined",size:"small",onClick:sl},{default:o(()=>[d(" Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð±Ð»Ð¾Ðº ("+u(i.value.text_blocks?i.value.text_blocks.length:0)+"/10) ",1)]),_:1})])):(m(),x("div",ra," Ð”Ð¾ÑÑ‚Ð¸Ð³Ð½ÑƒÑ‚ Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ (10 Ð±Ð»Ð¾ÐºÐ¾Ð²) "))])]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]),a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[...e[88]||(e[88]=[d("Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°",-1)])]),_:1}),a(Y,null,{default:o(()=>[a(z,{class:"my-4"}),a(M,null,{default:o(()=>[...e[89]||(e[89]=[d("ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ð¸",-1)])]),_:1}),a(h,{"prepend-icon":"mdi-plus",onClick:Qt},{default:o(()=>[...e[90]||(e[90]=[d("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ",-1)])]),_:1}),s("div",ua,[F.value.positions?(m(),g(ne,{key:0,type:"table"})):(m(),g(ie,{key:1,items:A.value,headers:Tt},{"item.material":o(({item:t})=>[d(u(ut(t.material_id)),1)]),"item.edge_material":o(({item:t})=>[d(u(ut(t.edge_material_id)),1)]),"item.edge_scheme":o(({item:t})=>[d(u(Wt(t)),1)]),"item.detail_type":o(({item:t})=>[d(u(dt(t.detail_type_id)),1)]),"item.width":o(({item:t})=>[a(w,{value:Math.round(t.width||0),type:"number",density:"compact","hide-details":"",style:{"max-width":"120px"},step:"1","onUpdate:modelValue":n=>Qe(t,"width",parseInt(n)||0)},null,8,["value","onUpdate:modelValue"])]),"item.length":o(({item:t})=>[a(w,{value:Math.round(t.length||0),type:"number",density:"compact","hide-details":"",style:{"max-width":"120px"},step:"1","onUpdate:modelValue":n=>Qe(t,"length",parseInt(n)||0)},null,8,["value","onUpdate:modelValue"])]),"item.area_single":o(({item:t})=>[d(u(((t.width||0)/1e3*((t.length||0)/1e3)).toFixed(4)),1)]),"item.quantity":o(({item:t})=>[a(w,{modelValue:t.quantity,"onUpdate:modelValue":n=>t.quantity=n,modelModifiers:{number:!0},type:"number",density:"compact","hide-details":"",style:{"max-width":"100px"},onBlur:()=>Qe(t,"quantity",t.quantity)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),"item.area_total":o(({item:t})=>[d(u(((t.width||0)/1e3*((t.length||0)/1e3)*(t.quantity||0)).toFixed(4)),1)]),"item.actions":o(({item:t})=>[s("div",da,[a(j,{onClick:n=>Yt(t),disabled:J.value!==null,class:Re(J.value!==null?"text-disabled":"cursor-pointer"),title:"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ"},{default:o(()=>[...e[91]||(e[91]=[d(" mdi-pencil ",-1)])]),_:1},8,["onClick","disabled","class"]),s("div",ma,[J.value!==t.id?(m(),g(j,{key:0,onClick:n=>el(t),disabled:J.value!==null,class:Re(J.value!==null?"text-disabled":"cursor-pointer"),title:"ÐšÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ"},{default:o(()=>[...e[92]||(e[92]=[d(" mdi-content-duplicate ",-1)])]),_:1},8,["onClick","disabled","class"])):(m(),g(Wl,{key:1,size:"24",width:"2",indeterminate:"",color:"primary",title:"ÐšÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ..."}))]),a(j,{onClick:n=>Zt(t),disabled:J.value!==null,class:Re(J.value!==null?"text-disabled":"cursor-pointer"),title:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ"},{default:o(()=>[...e[93]||(e[93]=[d(" mdi-delete ",-1)])]),_:1},8,["onClick","disabled","class"])])]),_:1},8,["items"]))]),a(z,{class:"my-4"}),a(M,null,{default:o(()=>[e[94]||(e[94]=d(" ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹ ",-1)),a(B),s("div",pa,"Ð˜Ñ‚Ð¾Ð³Ð¾: "+u(hl.value.toFixed(2))+" â‚½",1)]),_:1}),te.value.length>0?(m(),g($t,{key:0,class:"mt-2"},{default:o(()=>[s("div",ca,[s("div",null,[e[96]||(e[96]=s("span",null,"ÐŸÐ»Ð¸Ñ‚Ð½Ñ‹Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹",-1)),i.value.apply_waste_to_plate?C("",!0):(m(),g(ae,{key:0,size:"small",variant:"filled",color:"warning",class:"ml-2"},{default:o(()=>[...e[95]||(e[95]=[d(" ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ ",-1)])]),_:1}))]),a(ae,{size:"small",variant:"outlined",color:"info"},{default:o(()=>[d(u(i.value.use_area_calc_mode?"Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð¿Ð»Ð¾Ñ‰Ð°Ð´Ð¸":"Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð¿Ð¾ Ð»Ð¸ÑÑ‚Ð°Ð¼"),1)]),_:1})])]),_:1})):C("",!0),F.value.materials&&te.value.length===0?(m(),g(ne,{key:1,type:"table"})):te.value.length>0?(m(),g(ie,{key:2,items:te.value,headers:Et.value,density:"comfortable",class:"mb-4","show-expand":""},{"header.price_per_m2":o(({column:t})=>[a(Ut,{text:"Ð¦ÐµÐ½Ð° Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð° Ð¸Ð· Ñ†ÐµÐ½Ñ‹ Ð»Ð¸ÑÑ‚Ð°"},{activator:o(({props:n})=>[s("span",Pl(n,{class:"cursor-help"}),[d(u(t.title)+" ",1),a(ae,{size:"x-small",variant:"text",color:"grey-darken-1"},{default:o(()=>[...e[97]||(e[97]=[d("Ñ€Ð°ÑÑ‡.",-1)])]),_:1})],16)]),_:2},1024)]),"item.area_details":o(({item:t})=>[d(u(t.area_details.toFixed(2)),1)]),"item.waste_coeff":o(({item:t})=>[d(u((Number(t.waste_coeff)||1).toFixed(2)),1)]),"item.area_with_waste":o(({item:t})=>[d(u(t.area_with_waste.toFixed(2)),1)]),"item.sheet_area":o(({item:t})=>[!i.value.use_area_calc_mode&&t.sheet_area>0?(m(),g(Ut,{key:0,text:`${(t.sheet_area*1e6).toFixed(0)} Ð¼Ð¼Â²`},{activator:o(({props:n})=>[s("span",Ee(Se(n)),u(t.sheet_area.toFixed(4)),17)]),_:2},1032,["text"])):i.value.use_area_calc_mode?C("",!0):(m(),x("span",_a,"â€”"))]),"item.sheets_count":o(({item:t})=>[i.value.use_area_calc_mode?(m(),x("span",fa,u(t.area_with_waste.toFixed(2))+" Ð¼Â²",1)):(m(),x("span",va,u(t.sheets_count),1))]),"item.price_per_sheet":o(({item:t})=>[i.value.use_area_calc_mode?C("",!0):(m(),x("span",ga,u((Number(t.price_per_sheet)||0).toFixed(2))+" â‚½ ",1))]),"item.price_per_m2":o(({item:t})=>[i.value.use_area_calc_mode?(m(),x("span",ya,u((Number(t.price_per_m2)||0).toFixed(2))+" â‚½/Ð¼Â² ",1)):C("",!0)]),"item.total_price":o(({item:t})=>[i.value.use_area_calc_mode?(m(),x("span",wa,u((t.area_with_waste*(Number(t.price_per_m2)||0)).toFixed(2))+" â‚½ ",1)):(m(),x("span",ba,u((t.sheets_count*(Number(t.price_per_sheet)||0)).toFixed(2))+" â‚½ ",1))]),"expanded-row":o(({columns:t,item:n})=>[s("tr",null,[s("td",{colspan:t.length,class:"pa-4",style:{"background-color":"#f5f5f5"}},[a(Oe,{class:"pa-0"},{default:o(()=>[a(W,null,{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[...e[98]||(e[98]=[s("div",{class:"text-subtitle-2 mb-2"},[s("strong",null,"Ð¤Ð¾Ñ€Ð¼ÑƒÐ»Ð° Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð°:")],-1)])]),_:1})]),_:1}),a(W,null,{default:o(()=>[a(T,{cols:"12",md:"6"},{default:o(()=>[s("div",ha,[s("div",null,[e[99]||(e[99]=d("ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹: ",-1)),s("strong",null,u(n.area_details.toFixed(2))+" Ð¼Â²",1)]),s("div",null,[e[100]||(e[100]=d("ÐšÐ¾ÑÑ„. Ð¾Ñ‚Ñ…Ð¾Ð´Ð¾Ð²: ",-1)),s("strong",null,u((Number(n.waste_coeff)||1).toFixed(2)),1)]),s("div",null,[e[101]||(e[101]=d("ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ñ Ð¾Ñ‚Ñ…Ð¾Ð´Ð°Ð¼Ð¸: ",-1)),s("strong",null,u(n.area_with_waste.toFixed(2))+" Ð¼Â²",1)]),i.value.use_area_calc_mode?(m(),x(K,{key:1},[s("div",Fa,[e[109]||(e[109]=s("div",{class:"text-subtitle-2 mb-2"},[s("strong",null,"ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ€Ð°ÑÑ‡Ñ‘Ñ‚:")],-1)),s("div",null,[e[106]||(e[106]=d("ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ðº Ð¾Ð¿Ð»Ð°Ñ‚Ðµ: ",-1)),s("strong",null,u(n.area_with_waste.toFixed(2))+" Ð¼Â²",1)]),s("div",null,[e[107]||(e[107]=d("Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼Â² (Ñ€Ð°ÑÑ‡.): ",-1)),s("strong",null,u(n.price_per_m2.toFixed(2))+" â‚½/Ð¼Â²",1)]),s("div",$a,[e[108]||(e[108]=d("Ð˜Ñ‚Ð¾Ð³Ð¾: ",-1)),s("strong",null,u(n.area_with_waste.toFixed(2))+" Ã— "+u(n.price_per_m2.toFixed(2))+" = "+u((n.area_with_waste*n.price_per_m2).toFixed(2))+" â‚½",1)])]),s("div",Ua,[e[110]||(e[110]=s("div",{class:"mb-2"},[s("strong",null,"Ð¡Ð¿Ñ€Ð°Ð²Ð¾Ñ‡Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ:")],-1)),s("div",null,"Ð Ð°Ð·Ð¼ÐµÑ€ Ð»Ð¸ÑÑ‚Ð°: "+u(n.sheet_area.toFixed(4))+" Ð¼Â²",1),s("div",null,"Ð¦ÐµÐ½Ð° Ð·Ð° Ð»Ð¸ÑÑ‚: "+u((Number(n.price_per_sheet)||0).toFixed(2))+" â‚½",1),e[111]||(e[111]=s("div",{class:"mt-2"},"Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼Â² Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð° Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð½Ñ‹Ð¼ Ð¿ÑƒÑ‚Ñ‘Ð¼ Ð¸Ð· Ñ†ÐµÐ½Ñ‹ Ð»Ð¸ÑÑ‚Ð°:",-1)),s("div",null,u((Number(n.price_per_sheet)||0).toFixed(2))+" â‚½ / "+u(n.sheet_area.toFixed(4))+" Ð¼Â² = "+u(n.price_per_m2.toFixed(2))+" â‚½/Ð¼Â²",1)])],64)):(m(),x(K,{key:0},[s("div",null,[e[102]||(e[102]=d("ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ Ð»Ð¸ÑÑ‚Ð°: ",-1)),s("strong",null,u(n.sheet_area.toFixed(4))+" Ð¼Â²",1)]),s("div",ka,[e[103]||(e[103]=d("Ð›Ð¸ÑÑ‚Ð¾Ð²: ",-1)),s("strong",null,"ceil("+u(n.area_with_waste.toFixed(2))+" / "+u(n.sheet_area.toFixed(4))+") = "+u(n.sheets_count),1)]),s("div",Va,[e[104]||(e[104]=d("Ð¦ÐµÐ½Ð° Ð·Ð° Ð¼Â²: ",-1)),s("strong",null,u(n.price_per_m2.toFixed(2))+" â‚½/Ð¼Â²",1)]),s("div",Ca,[e[105]||(e[105]=d("Ð˜Ñ‚Ð¾Ð³Ð¾: ",-1)),s("strong",null,u(n.sheets_count)+" Ã— "+u((Number(n.price_per_sheet)||0).toFixed(2))+" = "+u((n.sheets_count*(Number(n.price_per_sheet)||0)).toFixed(2))+" â‚½",1)])],64))])]),_:2},1024),n.updated_at?(m(),g(T,{key:0,cols:"12",md:"6"},{default:o(()=>[e[115]||(e[115]=s("div",{class:"text-subtitle-2 mb-2"},[s("strong",null,"Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ñ†ÐµÐ½Ñ‹:")],-1)),s("div",Da,[s("div",null,[e[112]||(e[112]=d("Ð”Ð°Ñ‚Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ: ",-1)),s("strong",null,u(new Date(n.updated_at).toLocaleDateString("ru-RU")),1)]),n.source_url?(m(),x("div",ja,[a(h,{href:n.source_url,target:"_blank",size:"small",variant:"text",color:"primary","prepend-icon":"mdi-link-variant"},{default:o(()=>[...e[113]||(e[113]=[d(" ÐŸÐµÑ€ÐµÐ¹Ñ‚Ð¸ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñƒ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð° ",-1)])]),_:1},8,["href"])])):C("",!0),e[114]||(e[114]=s("div",{class:"text-caption text-grey mt-2"},"Ð¦ÐµÐ½Ð° Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð° Ð½Ð° ÑƒÐºÐ°Ð·Ð°Ð½Ð½ÑƒÑŽ Ð´Ð°Ñ‚Ñƒ",-1))])]),_:2},1024)):C("",!0)]),_:2},1024)]),_:2},1024)],8,xa)])]),_:1},8,["items","headers"])):C("",!0),le.value.length>0?(m(),g($t,{key:3,class:"mt-2"},{default:o(()=>[s("div",Na,[e[117]||(e[117]=s("span",null,"ÐšÑ€Ð¾Ð¼ÐºÐ°",-1)),i.value.apply_waste_to_edge?C("",!0):(m(),g(ae,{key:0,size:"small",variant:"filled",color:"warning"},{default:o(()=>[...e[116]||(e[116]=[d(" ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡ÐµÐ½ ",-1)])]),_:1}))])]),_:1})):C("",!0),F.value.materials&&le.value.length===0?(m(),g(ne,{key:4,type:"table"})):le.value.length>0?(m(),g(ie,{key:5,items:le.value,headers:Ot,density:"comfortable","show-expand":""},{"item.length_linear":o(({item:t})=>[d(u(t.length_linear.toFixed(2)),1)]),"item.waste_coeff":o(({item:t})=>[d(u((Number(t.waste_coeff)||1).toFixed(2)),1)]),"item.length_with_waste":o(({item:t})=>[d(u(t.length_with_waste.toFixed(2)),1)]),"item.price_per_unit":o(({item:t})=>[d(u((Number(t.price_per_unit)||0).toFixed(2))+" â‚½ ",1)]),"item.total_price":o(({item:t})=>[d(u((t.length_with_waste*(Number(t.price_per_unit)||0)).toFixed(2))+" â‚½ ",1)]),"expanded-row":o(({columns:t,item:n})=>[s("tr",null,[s("td",{colspan:t.length,class:"pa-4",style:{"background-color":"#f5f5f5"}},[a(Oe,{class:"pa-0"},{default:o(()=>[a(W,null,{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[...e[118]||(e[118]=[s("div",{class:"text-subtitle-2 mb-3"},[s("strong",null,"Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð´Ð»Ð¸Ð½Ñ‹ ÐºÑ€Ð¾Ð¼ÐºÐ¸:")],-1)])]),_:1})]),_:1}),a(W,null,{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[a(ke,{class:"border-table"},{default:o(()=>[e[120]||(e[120]=s("thead",null,[s("tr",null,[s("th",null,"ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ñ"),s("th",null,"Ð Ð°Ð·Ð¼ÐµÑ€ Ð´ÐµÑ‚Ð°Ð»Ð¸ (Ð¼Ð¼)"),s("th",null,"ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚Ð¾Ñ€Ñ†Ð¾Ð²"),s("th",null,"ÐŸÐµÑ€Ð¸Ð¼ÐµÑ‚Ñ€ Ð¾Ð´Ð½Ð¾Ð¹ (Ð¼)"),s("th",null,"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾"),s("th",null,"Ð˜Ñ‚Ð¾Ð³Ð¾ Ð´Ð»Ð¸Ð½Ð° (Ð¼)")])],-1)),s("tbody",null,[(m(!0),x(K,null,he(mt(n.id),r=>(m(),x("tr",{key:r.position_id},[s("td",null,u(r.position_name),1),s("td",null,u(r.width)+" Ã— "+u(r.length),1),s("td",null,u(r.edge_scheme_label),1),s("td",null,u(r.perimeter_one.toFixed(4)),1),s("td",null,u(r.quantity),1),s("td",null,[s("strong",null,u(r.total_length.toFixed(2)),1)])]))),128))]),s("tfoot",null,[s("tr",null,[e[119]||(e[119]=s("td",{colspan:"5",style:{"text-align":"right"}},[s("strong",null,"Ð’ÑÐµÐ³Ð¾:")],-1)),s("td",null,[s("strong",null,u(n.length_linear.toFixed(2))+" Ð¼",1)])])])]),_:2},1024)]),_:2},1024)]),_:2},1024),a(W,{class:"mt-4"},{default:o(()=>[a(T,{cols:"12",md:"6"},{default:o(()=>[s("div",Ma,[s("div",null,[e[121]||(e[121]=d("ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¾Ñ‚Ñ…Ð¾Ð´Ð¾Ð²: ",-1)),s("strong",null,u((Number(n.waste_coeff)||1).toFixed(2)),1)]),s("div",qa,[e[122]||(e[122]=d("Ð Ð°ÑÑ‡Ñ‘Ñ‚: ",-1)),s("strong",null,u(n.length_linear.toFixed(2))+" Ã— "+u((Number(n.waste_coeff)||1).toFixed(2))+" = "+u(n.length_with_waste.toFixed(2))+" Ð¼",1)]),e[123]||(e[123]=s("div",{class:"text-caption",style:{color:"#666","margin-top":"12px","line-height":"1.5"}},[s("strong",null,"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ:"),d(' ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÐµÑ‚ÑÑ Ðº Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñƒ Ð¸ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ ÐºÑ€Ð¾Ð¼ÐºÐ¾Ð¾Ð±Ð»Ð¸Ñ†Ð¾Ð²ÐºÐ¸. Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ "ÐšÑ€Ð¾Ð¼ÐºÐ¾Ð¾Ð±Ð»Ð¸Ñ†Ð¾Ð²ÐºÐ°" Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð° Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ ÑÑ‚Ð¾Ð³Ð¾ Ð¶Ðµ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð°. ')],-1))])]),_:2},1024)]),_:2},1024)]),_:2},1024)],8,Aa)])]),_:1},8,["items"])):C("",!0),a(z,{class:"my-4"}),a(M,null,{default:o(()=>[e[124]||(e[124]=d(" ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ ",-1)),a(B),s("div",La,"Ð˜Ñ‚Ð¾Ð³Ð¾: "+u(kl.value.toFixed(2))+" â‚½",1)]),_:1}),a(h,{"prepend-icon":"mdi-plus",onClick:Vl,class:"mb-2"},{default:o(()=>[...e[125]||(e[125]=[d("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ",-1)])]),_:1}),F.value.operations?(m(),g(ne,{key:6,type:"table"})):(m(),g(ie,{key:7,expanded:[Ye.value],items:qe.value,headers:yl,density:"comfortable","show-expand":"","item-value":"id","onClick:row":e[19]||(e[19]=(t,{item:n,expand:r})=>{r&&(Ye.value.value=Ye.value.value===n.id?null:n.id)})},{"item.quantity_display":o(({item:t})=>[d(u((typeof t.quantity=="number"?t.quantity:parseFloat(t.quantity||0)).toFixed(2)),1)]),"item.name":o(({item:t})=>[s("div",Ta,[s("span",null,u(t.name),1),t.is_manual?C("",!0):(m(),g(j,{key:0,size:"18",color:"blue"},{default:o(()=>[...e[126]||(e[126]=[d("mdi-robot",-1)])]),_:1}))])]),"item.cost_per_unit":o(({item:t})=>[s("div",Pa,u(parseFloat(t.cost_per_unit||0).toFixed(2))+" â‚½",1)]),"item.total_cost":o(({item:t})=>[d(u(parseFloat(t.total_cost).toFixed(2))+" â‚½ ",1)]),"item.source":o(({item:t})=>[a(ae,{size:"small",color:t.is_manual?"primary":"success",variant:"flat"},{default:o(()=>[d(u(t.is_manual?"Ð ÑƒÑ‡Ð½Ð°Ñ":"ÐÐ²Ñ‚Ð¾"),1)]),_:2},1032,["color"])]),"item.actions":o(({item:t})=>[t.is_manual?(m(),g(j,{key:0,onClick:n=>Fl(t),class:"me-2",color:"primary"},{default:o(()=>[...e[127]||(e[127]=[d(" mdi-pencil ",-1)])]),_:1},8,["onClick"])):C("",!0),t.is_manual?(m(),g(j,{key:1,onClick:n=>$l(t),color:"error",icon:"mdi-delete"},null,8,["onClick"])):C("",!0)]),"expanded-row":o(({columns:t,item:n})=>[s("tr",null,[s("td",{colspan:t.length,class:"pa-4",style:{"background-color":"#f5f5f5"}},[a(Oe,{class:"pa-0"},{default:o(()=>[a(W,null,{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[s("div",Sa,[s("strong",null,'Ð Ð°ÑÑ‡Ñ‘Ñ‚ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ "'+u(n.name)+'":',1)])]),_:2},1024)]),_:2},1024),U(n).type==="edging"?(m(),x(K,{key:0},[a(W,null,{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[a(ke,{class:"border-table"},{default:o(()=>[e[129]||(e[129]=s("thead",null,[s("tr",null,[s("th",null,"ÐŸÐ¾Ð·Ð¸Ñ†Ð¸Ñ / ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»"),s("th",{style:{"text-align":"right"}},"Ð”Ð»Ð¸Ð½Ð° (Ð¼)")])],-1)),s("tbody",null,[(m(!0),x(K,null,he(U(n).details,r=>(m(),x("tr",{key:`${r.position_name}-${r.material_name}`},[s("td",null,[s("div",null,u(r.position_name),1),s("div",Oa,u(r.material_name),1)]),s("td",za,u(r.length.toFixed(2)),1)]))),128))]),s("tfoot",null,[s("tr",null,[e[128]||(e[128]=s("td",null,[s("strong",null,"Ð˜Ñ‚Ð¾Ð³Ð¾:")],-1)),s("td",Wa,[s("strong",null,u(U(n).total_length.toFixed(2))+" Ð¼",1)])])])]),_:2},1024)]),_:2},1024)]),_:2},1024),a(W,{class:"mt-3"},{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[s("div",Ra,[s("div",null,[e[130]||(e[130]=d("ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°: ",-1)),s("strong",null,u((Number(U(n).waste_coeff)||1).toFixed(2)),1)]),s("div",Ba,[e[131]||(e[131]=d("Ðš Ð¾Ð¿Ð»Ð°Ñ‚Ðµ: ",-1)),s("strong",null,u(U(n).total_with_waste.toFixed(2))+" Ð¼.Ð¿.",1)]),s("div",Ia," ("+u(U(n).total_length.toFixed(2))+" Ã— "+u((Number(U(n).waste_coeff)||1).toFixed(2))+" = "+u(U(n).total_with_waste.toFixed(2))+" Ð¼.Ð¿.) ",1)])]),_:2},1024)]),_:2},1024)],64)):U(n).type==="sawing"?(m(),g(W,{key:1},{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[s("div",Ha,u(U(n).note),1),a(ke,{class:"border-table"},{default:o(()=>[e[133]||(e[133]=s("thead",null,[s("tr",null,[s("th",null,"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð»"),s("th",{style:{"text-align":"right"}},"ÐŸÐ»Ð¾Ñ‰Ð°Ð´ÑŒ (Ð¼Â²)")])],-1)),s("tbody",null,[(m(!0),x(K,null,he(U(n).details,r=>(m(),x("tr",{key:r.material_name},[s("td",null,u(r.material_name),1),s("td",Ja,u(r.area.toFixed(2)),1)]))),128))]),s("tfoot",null,[s("tr",null,[e[132]||(e[132]=s("td",null,[s("strong",null,"Ð˜Ñ‚Ð¾Ð³Ð¾:")],-1)),s("td",Ga,[s("strong",null,u(U(n).total_area.toFixed(2))+" Ð¼Â²",1)])])])]),_:2},1024)]),_:2},1024)]),_:2},1024)):U(n).type==="drilling"?(m(),g(W,{key:2},{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[U(n).details&&U(n).details.length>0?(m(),g(ke,{key:0,class:"border-table"},{default:o(()=>[e[135]||(e[135]=s("thead",null,[s("tr",null,[s("th",null,"Ð¢Ð¸Ð¿ Ð´ÐµÑ‚Ð°Ð»Ð¸"),s("th",{style:{"text-align":"right"}},"ÐžÑ‚Ð²ÐµÑ€ÑÑ‚Ð¸Ð¹ Ð½Ð° Ð´ÐµÑ‚Ð°Ð»ÑŒ"),s("th",{style:{"text-align":"right"}},"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹"),s("th",{style:{"text-align":"right"}},"Ð’ÑÐµÐ³Ð¾ Ð¾Ñ‚Ð²ÐµÑ€ÑÑ‚Ð¸Ð¹")])],-1)),s("tbody",null,[(m(!0),x(K,null,he(U(n).details,r=>(m(),x("tr",{key:r.detail_type_name},[s("td",null,u(r.detail_type_name),1),s("td",Ka,u(r.holes_per_piece),1),s("td",Qa,u(r.quantity),1),s("td",Ya,u(r.total_holes),1)]))),128))]),s("tfoot",null,[s("tr",null,[e[134]||(e[134]=s("td",{colspan:"3"},[s("strong",null,"Ð˜Ñ‚Ð¾Ð³Ð¾:")],-1)),s("td",Xa,[s("strong",null,u(U(n).total_holes)+" ÑˆÑ‚",1)])])])]),_:2},1024)):(m(),g(ze,{key:1,type:"info",variant:"tonal"},{default:o(()=>[d(u(U(n).message),1)]),_:2},1024))]),_:2},1024)]),_:2},1024)):(m(),g(W,{key:3},{default:o(()=>[a(T,{cols:"12"},{default:o(()=>[a(ze,{type:"info",variant:"tonal"},{default:o(()=>[d(u(U(n).message),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))]),_:2},1024)],8,Ea)])]),_:1},8,["expanded","items"])),a(z,{class:"my-4"}),a(M,null,{default:o(()=>[...e[136]||(e[136]=[d("Ð¤ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ð°",-1)])]),_:1}),a(h,{"prepend-icon":"mdi-plus",onClick:tl},{default:o(()=>[...e[137]||(e[137]=[d("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ„ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ñƒ",-1)])]),_:1}),F.value.fittings?(m(),g(ne,{key:8,type:"table",class:"mt-3"})):(m(),g(ie,{key:9,items:at.value,headers:Pt},{"item.actions":o(({item:t})=>[a(j,{onClick:oe(n=>ll(t),["stop"]),class:"me-2"},{default:o(()=>[...e[138]||(e[138]=[d("mdi-pencil",-1)])]),_:1},8,["onClick"]),a(j,{onClick:oe(n=>ol(t),["stop"])},{default:o(()=>[...e[139]||(e[139]=[d("mdi-delete",-1)])]),_:1},8,["onClick"])]),_:1},8,["items"])),a(z,{class:"my-4"}),a(M,null,{default:o(()=>[e[140]||(e[140]=d(" ÐÐ¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ",-1)),a(B),s("div",Za,"Ð˜Ñ‚Ð¾Ð³Ð¾: "+u((typeof xt.value=="number"?xt.value:0).toFixed(2))+" â‚½",1)]),_:1}),we.value?(m(),g(ze,{key:10,type:"warning",variant:"tonal",class:"mb-3",closable:""},{default:o(()=>[...e[141]||(e[141]=[s("strong",null,"âš  ÐÐµ Ð²ÑÐµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ð¸ Ð¸Ð¼ÐµÑŽÑ‚ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÑÑ‚Ð°Ð²ÐºÐ¸",-1),d(' â€” Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ "ÐŸÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ ÑÑ‚Ð°Ð²ÐºÐ¸" Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ð¸Ð»Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ. ',-1)])]),_:1})):C("",!0),a(h,{"prepend-icon":"mdi-plus",onClick:jl,class:"mb-3"},{default:o(()=>[...e[142]||(e[142]=[d("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ",-1)])]),_:1}),a(h,{"prepend-icon":"mdi-refresh",onClick:Ul,class:"mb-3 ms-3",variant:"outlined",loading:Te.value,disabled:Te.value},{default:o(()=>[...e[143]||(e[143]=[d(" ÐŸÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ ÑÑ‚Ð°Ð²ÐºÐ¸ ",-1)])]),_:1},8,["loading","disabled"]),a(h,{"prepend-icon":xe.value?"mdi-lock":"mdi-lock-open",onClick:Dl,class:"mb-3 ms-3",variant:"outlined",color:xe.value?"success":"warning",loading:Pe.value,disabled:Pe.value},{default:o(()=>[d(u(xe.value?"Ð¡Ñ‚Ð°Ð²ÐºÐ¸ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹":"Ð—Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ð°Ð²ÐºÐ¸"),1)]),_:1},8,["prepend-icon","color","loading","disabled"]),xe.value?(m(),g(ae,{key:11,color:"success","text-color":"white","prepend-icon":"mdi-check-circle",class:"mb-3 ms-3"},{default:o(()=>[...e[144]||(e[144]=[d(" Ð—Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð° ",-1)])]),_:1})):(m(),g(ae,{key:12,color:"warning","text-color":"white","prepend-icon":"mdi-alert-circle",class:"mb-3 ms-3"},{default:o(()=>[...e[145]||(e[145]=[d(" ÐÐµ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð° ",-1)])]),_:1})),F.value.laborWorks?(m(),g(ne,{key:13,type:"table"})):(m(),g(ie,{key:14,items:G.value,headers:bl,density:"comfortable","item-value":"id",class:"mb-4"},{"item.basis":o(({item:t})=>[d(u(t.basis||"â€”"),1)]),"item.hours":o(({item:t})=>[d(u(typeof t.hours=="number"?t.hours.toFixed(2):parseFloat(t.hours||0).toFixed(2)),1)]),"item.rate":o(({item:t})=>[s("div",eo,u((parseFloat(t.rate_per_hour)||0).toFixed(2))+" â‚½/Ñ‡",1)]),"item.cost":o(({item:t})=>[s("div",{style:Ft([{"text-align":"right",width:"120px"},{color:(parseFloat(t.cost_total)||0)===0&&(i.value.normohour_rate||0)>0?"#666":"inherit"}])},[s("strong",null,u((parseFloat(t.cost_total)||0).toFixed(2))+" â‚½",1)],4)]),"item.actions":o(({item:t})=>[a(j,{onClick:n=>Nl(t),class:"me-2",color:"primary",size:"small"},{default:o(()=>[...e[146]||(e[146]=[d(" mdi-pencil ",-1)])]),_:1},8,["onClick"]),a(j,{onClick:n=>Al(t),color:"error",size:"small"},{default:o(()=>[...e[147]||(e[147]=[d(" mdi-delete ",-1)])]),_:1},8,["onClick"])]),"no-data":o(()=>[...e[148]||(e[148]=[s("div",{class:"text-center py-8 text-grey"}," ÐœÐ¾Ð½Ñ‚Ð°Ð¶Ð½Ð¾-ÑÐ±Ð¾Ñ€Ð¾Ñ‡Ð½Ñ‹Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð½Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ñ‹ ",-1)])]),_:1},8,["items"])),a(z,{class:"my-4"}),a(M,null,{default:o(()=>[e[149]||(e[149]=d("ÐÐ°ÐºÐ»Ð°Ð´Ð½Ñ‹Ðµ Ñ€Ð°ÑÑ…Ð¾Ð´Ñ‹ ",-1)),s("div",to,"Ð˜Ñ‚Ð¾Ð³Ð¾: "+u((Array.isArray(Z.value)?Z.value.reduce((t,n)=>t+(parseFloat(n.amount)||0),0):0).toFixed(2))+" â‚½",1)]),_:1}),s("div",lo,[a(h,{"prepend-icon":"mdi-plus",onClick:_l},{default:o(()=>[...e[150]||(e[150]=[d("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÑ…Ð¾Ð´",-1)])]),_:1})]),F.value.expenses?(m(),g(ne,{key:15,type:"table"})):(m(),g(ie,{key:16,items:Z.value,headers:zt},{"item.amount":o(({item:t})=>[d(u(Number(t.amount||0).toFixed(2))+" â‚½ ",1)]),"item.actions":o(({item:t})=>[a(j,{onClick:oe(n=>vl(t),["stop"]),class:"me-2"},{default:o(()=>[...e[151]||(e[151]=[d("mdi-pencil",-1)])]),_:1},8,["onClick"]),a(j,{onClick:oe(n=>gl(t),["stop"])},{default:o(()=>[...e[152]||(e[152]=[d("mdi-delete",-1)])]),_:1},8,["onClick"])]),_:1},8,["items"])),a(z,{class:"my-4"}),a(h,{color:"secondary",onClick:cl,loading:Ue.value,disabled:Ue.value},{default:o(()=>[...e[153]||(e[153]=[d("Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ PDF",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),a(se,{modelValue:de.value,"onUpdate:modelValue":e[30]||(e[30]=t=>de.value=t),"max-width":"700"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(De.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸ÑŽ":"ÐÐ¾Ð²Ð°Ñ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ñ"),1)]),_:1}),a(Y,null,{default:o(()=>[a(Ze,{ref_key:"positionForm",ref:rt},{default:o(()=>[a(X,{modelValue:y.value.detail_type_id,"onUpdate:modelValue":[e[21]||(e[21]=t=>y.value.detail_type_id=t),Rt],items:H.value,"item-title":"name","item-value":"id",label:"Ð¢Ð¸Ð¿ Ð´ÐµÑ‚Ð°Ð»Ð¸",clearable:"",density:"comfortable",class:"mb-3"},{"append-inner":o(()=>[a(h,{icon:"mdi-plus",size:"x-small",variant:"tonal",color:"primary",onClick:oe(Ml,["stop"]),title:"Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ‚Ð¸Ð¿ Ð´ÐµÑ‚Ð°Ð»Ð¸"})]),"append-item":o(()=>[a(We,{onClick:e[20]||(e[20]=t=>l.$router.push("/detail-types"))},{default:o(()=>[a(Rl,null,{default:o(()=>[...e[154]||(e[154]=[d("Ð£Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ‚Ð¸Ð¿Ð°Ð¼Ð¸",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","items"]),a(X,{modelValue:y.value.material_id,"onUpdate:modelValue":[e[22]||(e[22]=t=>y.value.material_id=t),Ht],items:qt.value,"item-title":"name","item-value":"id",label:"ÐŸÐ»Ð¸Ñ‚Ð½Ñ‹Ð¹ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»",rules:[t=>!!t||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾"],density:"comfortable",class:"mb-3"},{item:o(({props:t,item:n})=>[a(We,Ee(Se(t)),{default:o(()=>[n.raw.origin==="parser"?(m(),g(tt,{key:0,class:"text-blue"},{default:o(()=>[...e[155]||(e[155]=[d(" Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ð¹ (ÑÐ¿Ð°Ñ€ÑÐµÐ½Ð¾) ",-1)])]),_:1})):(m(),g(tt,{key:1,class:"text-grey"},{default:o(()=>[...e[156]||(e[156]=[d(" ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ ",-1)])]),_:1}))]),_:2},1040)]),_:1},8,["modelValue","items","rules"]),a(W,null,{default:o(()=>[a(T,{cols:"6"},{default:o(()=>[a(w,{modelValue:y.value.width,"onUpdate:modelValue":e[23]||(e[23]=t=>y.value.width=t),modelModifiers:{number:!0},label:"Ð¨Ð¸Ñ€Ð¸Ð½Ð°, Ð¼Ð¼",type:"number",rules:[t=>t>0||"Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ > 0"],density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),a(T,{cols:"6"},{default:o(()=>[a(w,{modelValue:y.value.length,"onUpdate:modelValue":e[24]||(e[24]=t=>y.value.length=t),modelModifiers:{number:!0},label:"Ð”Ð»Ð¸Ð½Ð°, Ð¼Ð¼",type:"number",rules:[t=>t>0||"Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ > 0"],density:"comfortable"},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(w,{modelValue:y.value.quantity,"onUpdate:modelValue":e[25]||(e[25]=t=>y.value.quantity=t),modelModifiers:{number:!0},label:"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",type:"number",min:1,rules:[t=>t>=1||"ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ 1"],density:"comfortable",class:"mb-3"},null,8,["modelValue","rules"]),a(X,{modelValue:y.value.edge_scheme,"onUpdate:modelValue":[e[26]||(e[26]=t=>y.value.edge_scheme=t),Jt],items:it,"item-title":"label","item-value":"value",label:"ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚Ð¾Ñ€Ñ†Ð¾Ð²",disabled:!!y.value.detail_type_id,density:"comfortable",class:"mb-3"},{selection:o(({item:t})=>[a(ae,{size:"small"},{default:o(()=>[a(j,{start:"",size:"16"},{default:o(()=>[d(u(t.raw.icon),1)]),_:2},1024),d(" "+u(t.raw.label),1)]),_:2},1024)]),item:o(({props:t,item:n})=>[a(We,Ee(Se(t)),{prepend:o(()=>[a(j,null,{default:o(()=>[d(u(n.raw.icon),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","disabled"]),y.value.edge_scheme&&y.value.edge_scheme!=="none"?(m(),g(X,{key:0,modelValue:y.value.edge_material_id,"onUpdate:modelValue":[e[27]||(e[27]=t=>y.value.edge_material_id=t),Gt],items:Lt.value,"item-title":"name","item-value":"id",label:"ÐœÐ°Ñ‚ÐµÑ€Ð¸Ð°Ð» ÐºÑ€Ð¾Ð¼ÐºÐ¸",rules:[t=>!!t||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾"],density:"comfortable",class:"mb-3"},null,8,["modelValue","items","rules"])):C("",!0),a(w,{modelValue:y.value.custom_name,"onUpdate:modelValue":e[28]||(e[28]=t=>y.value.custom_name=t),label:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð´ÐµÑ‚Ð°Ð»Ð¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)",hint:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Â«ÐŸÐ¾Ð»ÐºÐ° Ð»ÐµÐ²Ð°ÑÂ»","persistent-hint":"",density:"comfortable"},null,8,["modelValue"])]),_:1},512)]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:e[29]||(e[29]=t=>de.value=!1)},{default:o(()=>[...e[157]||(e[157]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:Xt},{default:o(()=>[...e[158]||(e[158]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:me.value,"onUpdate:modelValue":e[38]||(e[38]=t=>me.value=t),"max-width":"600"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(je.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ñƒ":"ÐÐ¾Ð²Ð°Ñ Ñ„ÑƒÑ€Ð½Ð¸Ñ‚ÑƒÑ€Ð°"),1)]),_:1}),a(Y,null,{default:o(()=>[a(w,{modelValue:$.value.name,"onUpdate:modelValue":e[31]||(e[31]=t=>$.value.name=t),label:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ",required:""},null,8,["modelValue"]),a(w,{modelValue:$.value.article,"onUpdate:modelValue":e[32]||(e[32]=t=>$.value.article=t),label:"ÐÑ€Ñ‚Ð¸ÐºÑƒÐ» (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)"},null,8,["modelValue"]),a(X,{modelValue:$.value.unit,"onUpdate:modelValue":e[33]||(e[33]=t=>$.value.unit=t),items:ge.value,label:"Ð•Ð´. Ð¸Ð·Ð¼.",rules:[t=>!!t||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾"],density:"comfortable",class:"mb-3",clearable:""},null,8,["modelValue","items","rules"]),a(w,{modelValue:$.value.quantity,"onUpdate:modelValue":e[34]||(e[34]=t=>$.value.quantity=t),modelModifiers:{number:!0},label:"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",type:"number"},null,8,["modelValue"]),a(w,{modelValue:$.value.unit_price,"onUpdate:modelValue":e[35]||(e[35]=t=>$.value.unit_price=t),modelModifiers:{number:!0},label:"Ð¦ÐµÐ½Ð° Ð·Ð° ÑˆÑ‚, â‚½",type:"number"},null,8,["modelValue"]),a(fe,{modelValue:$.value.note,"onUpdate:modelValue":e[36]||(e[36]=t=>$.value.note=t),label:"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)",rows:"2","auto-grow":""},null,8,["modelValue"])]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:e[37]||(e[37]=t=>me.value=!1)},{default:o(()=>[...e[159]||(e[159]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:al},{default:o(()=>[...e[160]||(e[160]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:pe.value,"onUpdate:modelValue":e[43]||(e[43]=t=>pe.value=t),"max-width":"600"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(Ne.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€Ð°ÑÑ…Ð¾Ð´":"ÐÐ¾Ð²Ñ‹Ð¹ Ñ€Ð°ÑÑ…Ð¾Ð´"),1)]),_:1}),a(Y,null,{default:o(()=>[a(w,{modelValue:S.value.name,"onUpdate:modelValue":e[39]||(e[39]=t=>S.value.name=t),label:"ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð”Ð¾ÑÑ‚Ð°Ð²ÐºÐ°, ÐœÐ¾Ð½Ñ‚Ð°Ð¶, ÐšÐ¾Ð½ÑÑƒÐ»ÑŒÑ‚Ð°Ñ†Ð¸Ñ",required:"",class:"mb-3"},null,8,["modelValue"]),a(fe,{modelValue:S.value.description,"onUpdate:modelValue":e[40]||(e[40]=t=>S.value.description=t),label:"ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ",placeholder:"Ð”ÐµÑ‚Ð°Ð»Ð¸ Ñ€Ð°ÑÑ…Ð¾Ð´Ð°",rows:"3",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:S.value.amount,"onUpdate:modelValue":e[41]||(e[41]=t=>S.value.amount=t),modelModifiers:{number:!0},label:"Ð¡ÑƒÐ¼Ð¼Ð°, â‚½",type:"number",step:"0.01",min:"0"},null,8,["modelValue"])]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:e[42]||(e[42]=t=>pe.value=!1)},{default:o(()=>[...e[161]||(e[161]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:fl},{default:o(()=>[...e[162]||(e[162]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:Ie.value,"onUpdate:modelValue":e[47]||(e[47]=t=>Ie.value=t),"max-width":"700"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[e[163]||(e[163]=d(" ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ð° ",-1)),ee.value?(m(),x("span",ao," ("+u(ee.value==="plate"?"ÐŸÐ»Ð¸Ñ‚Ð½Ñ‹Ðµ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ñ‹":ee.value==="edge"?"ÐšÑ€Ð¾Ð¼ÐºÐ°":"ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ð¸")+") ",1)):C("",!0)]),_:1}),a(Y,{class:"mt-4"},{default:o(()=>[a(w,{modelValue:N.value.title,"onUpdate:modelValue":e[44]||(e[44]=t=>N.value.title=t),label:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÐœÐµÑ‚Ð¾Ð´Ð¸ÐºÐ° Ñ€Ð°ÑÑ‡Ñ‘Ñ‚Ð°, ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ, Ð£ÑÐ»Ð¾Ð²Ð¸Ñ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ",counter:"100",maxlength:"100",class:"mb-3"},null,8,["modelValue"]),a(fe,{modelValue:N.value.text,"onUpdate:modelValue":e[45]||(e[45]=t=>N.value.text=t),label:"Ð¢ÐµÐºÑÑ‚ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ",variant:"outlined",rows:"4",placeholder:"Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ñ‚ÐµÐºÑÑ‚ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ñ (Ð¼Ð°ÐºÑÐ¸Ð¼ÑƒÐ¼ 3000 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð², HTML ÑƒÐ´Ð°Ð»ÑÐµÑ‚ÑÑ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸)",counter:"3000",maxlength:"3000",onInput:e[46]||(e[46]=t=>N.value.text=I(N.value.text)),onPaste:dl,class:"mb-2"},null,8,["modelValue"]),N.value.text.length>0?(m(),x("div",oo," Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¾Ð²: "+u(N.value.text.length)+"/3000 ",1)):C("",!0)]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:vt},{default:o(()=>[...e[164]||(e[164]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:ul},{default:o(()=>[...e[165]||(e[165]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:He.value,"onUpdate:modelValue":e[55]||(e[55]=t=>He.value=t),"max-width":"700"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(Je.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº":"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº ÑÑ‚Ð°Ð²ÐºÐ¸"),1)]),_:1}),a(Y,{class:"mt-4"},{default:o(()=>[a(w,{modelValue:b.value.source,"onUpdate:modelValue":e[48]||(e[48]=t=>b.value.source=t),label:"Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº *",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: hh.ru, Avito, Ð˜Ð½Ð´ÐµÐºÑ Ð·Ð°Ñ€Ð¿Ð»Ð°Ñ‚, ÐžÐ¿Ñ€Ð¾Ñ Ð¿Ð¾Ð´Ñ€ÑÐ´Ñ‡Ð¸ÐºÐ¾Ð²",counter:"255",maxlength:"255",error:!!R.value.source,"error-messages":R.value.source?[R.value.source]:[],class:"mb-3"},null,8,["modelValue","error","error-messages"]),a(w,{modelValue:b.value.position_profile,"onUpdate:modelValue":e[49]||(e[49]=t=>b.value.position_profile=t),label:"ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚Ð¸",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð¡Ð±Ð¾Ñ€Ñ‰Ð¸Ðº Ð¼ÐµÐ±ÐµÐ»Ð¸, ÐŸÐ»Ð¾Ñ‚Ð½Ð¸Ðº ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ 3, ÐœÐ¾Ð½Ñ‚Ð°Ð¶Ð½Ð¸Ðº",counter:"255",maxlength:"255",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:b.value.salary_range,"onUpdate:modelValue":e[50]||(e[50]=t=>b.value.salary_range=t),label:"Ð—Ð°Ñ€Ð¿Ð»Ð°Ñ‚Ð°/Ð²Ð¸Ð»ÐºÐ°",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 1000-1200 â‚½/Ñ‡ Ð¸Ð»Ð¸ 75000-85000 â‚½/Ð¼ÐµÑÑÑ†",counter:"255",maxlength:"255",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:b.value.period,"onUpdate:modelValue":e[51]||(e[51]=t=>b.value.period=t),label:"ÐŸÐµÑ€Ð¸Ð¾Ð´",variant:"outlined",density:"compact",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: ÑÐ½Ð²Ð°Ñ€Ñ 2026, ÐºÐ²Ð°Ñ€Ñ‚Ð°Ð» 4 2025",counter:"50",maxlength:"50",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:b.value.link,"onUpdate:modelValue":e[52]||(e[52]=t=>b.value.link=t),label:"Ð¡ÑÑ‹Ð»ÐºÐ° Ð½Ð° Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº",variant:"outlined",density:"compact",placeholder:"https://hh.ru/...",counter:"1000",maxlength:"1000",onBlur:e[53]||(e[53]=t=>b.value.link=b.value.link?b.value.link.trim():null),error:!!R.value.link,"error-messages":R.value.link?[R.value.link]:[],class:"mb-3"},null,8,["modelValue","error","error-messages"]),a(fe,{modelValue:b.value.note,"onUpdate:modelValue":e[54]||(e[54]=t=>b.value.note=t),label:"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ",variant:"outlined",rows:"2",placeholder:"Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¾ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐµ",counter:"1000",maxlength:"1000",class:"mb-2"},null,8,["modelValue"]),b.value.note?(m(),x("div",so," Ð¡Ð¸Ð¼Ð²Ð¾Ð»Ð¾Ð²: "+u(b.value.note.length)+"/1000 ",1)):C("",!0),e[166]||(e[166]=s("div",{class:"text-caption text-orange"}," * â€” Ð¿Ð¾Ð»Ðµ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ",-1))]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:gt},{default:o(()=>[...e[167]||(e[167]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:pl},{default:o(()=>[...e[168]||(e[168]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(se,{modelValue:ce.value,"onUpdate:modelValue":e[60]||(e[60]=t=>ce.value=t),"max-width":"600"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(Le.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸ÑŽ":"ÐÐ¾Ð²Ð°Ñ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ñ"),1)]),_:1}),a(Y,null,{default:o(()=>[a(X,{modelValue:O.value.operation_id,"onUpdate:modelValue":e[56]||(e[56]=t=>O.value.operation_id=t),items:yt.value,"item-title":"name","item-value":"id",label:"ÐžÐ¿ÐµÑ€Ð°Ñ†Ð¸Ñ",rules:[t=>!!t||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾"],density:"comfortable","return-object":"",class:"mb-3"},{item:o(({props:t,item:n})=>[a(We,Ee(Se(t)),{default:o(()=>[a(tt,null,{default:o(()=>[d(u(n.raw.category),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules"]),a(w,{modelValue:O.value.quantity,"onUpdate:modelValue":e[57]||(e[57]=t=>O.value.quantity=t),modelModifiers:{number:!0},label:"ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾",type:"number",min:"0.01",step:"0.01",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(w,{modelValue:O.value.note,"onUpdate:modelValue":e[58]||(e[58]=t=>O.value.note=t),label:"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)",density:"comfortable"},null,8,["modelValue"])]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:e[59]||(e[59]=t=>ce.value=!1)},{default:o(()=>[...e[169]||(e[169]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:Cl},{default:o(()=>[...e[170]||(e[170]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(se,{modelValue:_e.value,"onUpdate:modelValue":e[67]||(e[67]=t=>_e.value=t),"max-width":"600"},{default:o(()=>[a(Q,null,{default:o(()=>[a(M,null,{default:o(()=>[d(u(be.value?"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ":"Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ"),1)]),_:1}),a(Y,null,{default:o(()=>[a(Ze,{ref_key:"laborWorkFormRef",ref:wt,onSubmit:oe(ht,["prevent"])},{default:o(()=>[a(w,{modelValue:D.value.title,"onUpdate:modelValue":e[61]||(e[61]=t=>D.value.title=t),label:"ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹",rules:[t=>!!t||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾",t=>t&&t.length<=255||"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 255 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²"],density:"comfortable",class:"mb-3"},null,8,["modelValue","rules"]),a(w,{modelValue:D.value.basis,"onUpdate:modelValue":e[62]||(e[62]=t=>D.value.basis=t),label:"ÐžÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ (Ð“ÐžÐ¡Ð¢/Ð¢Ð£)",placeholder:"ÐÐ°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: Ð¿. 5.2.4 Ð“ÐžÐ¡Ð¢ 16371-2014",rules:[t=>!t||t.length<=500||"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 500 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²"],density:"comfortable",class:"mb-3"},null,8,["modelValue","rules"]),a(w,{modelValue:D.value.hours,"onUpdate:modelValue":e[63]||(e[63]=t=>D.value.hours=t),modelModifiers:{number:!0},label:"ÐÐ¾Ñ€Ð¼Ð°, Ñ‡",type:"number",min:"0",step:"0.25",rules:[t=>t!=null&&t!==""||"ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾",t=>t>=0||"ÐÐµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¼ÐµÐ½ÑŒÑˆÐµ 0",t=>t<=999.99||"ÐÐµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐµ 999.99"],density:"comfortable",class:"mb-3"},null,8,["modelValue","rules"]),a(Bl,{modelValue:D.value.position_profile_id,"onUpdate:modelValue":e[64]||(e[64]=t=>D.value.position_profile_id=t),label:"ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚Ð¸ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)",items:bt.value,"item-title":"name","item-value":"id",placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð°Ð²ÐºÐ¸...",density:"comfortable",class:"mb-3",clearable:""},null,8,["modelValue","items"]),a(fe,{modelValue:D.value.note,"onUpdate:modelValue":e[65]||(e[65]=t=>D.value.note=t),label:"ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)",placeholder:"Ð§Ñ‚Ð¾ Ð²ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¾ Ð² Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ, Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ...",rules:[t=>!t||t.length<=5e3||"ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 5000 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²"],rows:"3",density:"comfortable",class:"mb-3"},null,8,["modelValue","rules"]),D.value.hours?(m(),g(ze,{key:0,type:"info",variant:"tonal",class:"mb-3"},{default:o(()=>[i.value.normohour_rate?(m(),x("div",no,[e[171]||(e[171]=s("strong",null,"ÐŸÑ€Ð¸Ð±Ð»Ð¸Ð·Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ ÑÑƒÐ¼Ð¼Ð°:",-1)),d(" "+u((D.value.hours*(i.value.normohour_rate||0)).toFixed(2))+" â‚½ ",1),s("div",io," ("+u(D.value.hours.toFixed(2))+" Ñ‡ Ã— "+u((i.value.normohour_rate||0).toFixed(2))+" â‚½/Ñ‡) ",1),e[172]||(e[172]=s("div",{class:"text-caption mt-2",style:{"font-style":"italic"}}," * Ð Ð°ÑÑ‡ÐµÑ‚ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ. Ð¤Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÑƒÐ¼Ð¼Ð° Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ ",-1))])):(m(),x("div",ro," Ð¤Ð°ÐºÑ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ ÑÑƒÐ¼Ð¼Ð° Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð° Ð¿Ð¾ÑÐ»Ðµ Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ ÑÑ‚Ð°Ð²Ð¾Ðº "))]),_:1})):C("",!0)]),_:1},512)]),_:1}),a(re,null,{default:o(()=>[a(B),a(h,{onClick:e[66]||(e[66]=t=>_e.value=!1)},{default:o(()=>[...e[173]||(e[173]=[d("ÐžÑ‚Ð¼ÐµÐ½Ð°",-1)])]),_:1}),a(h,{color:"primary",onClick:ht,loading:Xe.value},{default:o(()=>[...e[174]||(e[174]=[d("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(El,{modelValue:ue.value.show,"onUpdate:modelValue":e[68]||(e[68]=t=>ue.value.show=t),timeout:ue.value.timeout,color:ue.value.color,location:"bottom right"},{default:o(()=>[d(u(ue.value.message),1)]),_:1},8,["modelValue","timeout","color"])],64))}}),co=jt(uo,[["__scopeId","data-v-c44ee5eb"]]);export{co as default};
