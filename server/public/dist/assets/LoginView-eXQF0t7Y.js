import{be as y,r as o,C as b,D as l,G as a,bi as p,cj as V,bk as C,F as x}from"./vendor-CKnqOB-T.js";import{u as k,V as h,a as R,b as T,c as j,d as q,e as A,f as v,g as B,h as F,i as K,j as S,k as w,_ as U}from"./index-B66HMlcK.js";const E=y({__name:"LoginView",setup(L){const _=k(),g=C(),u=o(""),n=o(""),r=o(!1),m=o(),i=o(!1),d={required:t=>!!t&&t.trim()!==""||"Обязательное поле",email:t=>/.+@.+\..+/.test(t)||"Некорректный e-mail"},f=async()=>{r.value&&await c()},c=async()=>{const{valid:t}=await m.value?.validate()??{valid:!1};if(t){i.value=!0;try{await w.get("/sanctum/csrf-cookie");const e=await w.post("/api/login",{email:u.value,password:n.value});await _.checkAuth(!0),await g.push({name:"home"})}catch(e){console.error("Ошибка входа:",e),alert(e.response?.data?.message||e.message||"Ошибка авторизации")}finally{i.value=!1}}};return(t,e)=>(x(),b(h,{class:"fill-height",fluid:""},{default:l(()=>[a(S,{align:"center",justify:"center"},{default:l(()=>[a(R,{cols:"12",sm:"4",md:"3"},{default:l(()=>[a(T,null,{default:l(()=>[a(j,{class:"text-h6"},{default:l(()=>[...e[3]||(e[3]=[p("Вход в систему",-1)])]),_:1}),a(q,null,{default:l(()=>[a(A,{ref_key:"formRef",ref:m,modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value=s)},{default:l(()=>[a(v,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),label:"E-mail",type:"email",autocomplete:"email",rules:[d.required,d.email],onKeydown:V(f,["enter"])},null,8,["modelValue","rules"]),a(v,{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),label:"Пароль",type:"password",autocomplete:"current-password",rules:[d.required],onKeydown:V(f,["enter"])},null,8,["modelValue","rules"])]),_:1},8,["modelValue"])]),_:1}),a(B,null,{default:l(()=>[a(F),a(K,{color:"primary",class:"text-none",loading:i.value,disabled:!r.value,onClick:c},{default:l(()=>[...e[4]||(e[4]=[p(" Войти ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),G=U(E,[["__scopeId","data-v-0ec1b03b"]]);export{G as default};
